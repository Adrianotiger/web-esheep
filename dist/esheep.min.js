"use strict";var _createClass=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var VERSION="0.8.0",ACTIVATE_DEBUG=!1,DEFAULT_XML="https://adrianotiger.github.io/desktopPet/Pets/esheep64/animations.xml",COLLISION_WITH=["div","hr"],eSheep=function(){function eSheep(e,t){_classCallCheck(this,eSheep),this.userOptions=e||{allowPets:"none",allowPopup:"yes"},this.userOptions.allowPopup||(this.userOptions.allowPopup="yes"),this.userOptions.allowPets||(this.userOptions.allowPets="none"),this.animationFile=DEFAULT_XML,this.id=Date.now()+Math.random(),this.DOMdiv=document.createElement("div"),this.DOMdiv.setAttribute("id",this.id),this.DOMimg=document.createElement("img"),this.DOMinfo=document.createElement("div"),this.parser=new DOMParser,this.xmlDoc=null,this.prepareToDie=!1,this.isChild=null!=t,this.tilesX=1,this.tilesY=1,this.imageW=1,this.imageH=1,this.imageX=1,this.imageY=1,this.flipped=!1,this.dragging=!1,this.infobox=!1,this.animationId=0,this.animationStep=0,this.animationNode=null,this.sprite=new Image,this.HTMLelement=null,this.randS=100*Math.random(),this.screenW=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.screenH=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}return _createClass(eSheep,[{key:"Start",value:function(e){void 0!==e&&null!=e&&(this.animationFile=e);var t=new XMLHttpRequest,i=this;t.open("GET",this.animationFile,!0),t.addEventListener("readystatechange",function(){4==this.readyState&&(200==this.status?i._parseXML(this.responseText):console.error("XML not available:"+this.statusText+"\n"+this.responseText))}),t.send(null)}},{key:"remove",value:function(){var e=this;this.prepareToDie=!0,this.DOMinfo.Hide(),setTimeout(function(){e.DOMdiv=e.DOMimg=e.DOMinfo=null,document.getElementById(e.id).outerHTML=""},500)}},{key:"_parseXML",value:function(e){var n=this;this.xmlDoc=this.parser.parseFromString(e,"text/xml");var t=this.xmlDoc.getElementsByTagName("image")[0];this.tilesX=t.getElementsByTagName("tilesx")[0].textContent,this.tilesY=t.getElementsByTagName("tilesy")[0].textContent,this.sprite.addEventListener("load",function(){ACTIVATE_DEBUG&&console.log("Sprite image loaded");var e="width:"+n.sprite.width+"px;height:"+n.sprite.height+"px;position:absolute;top:0px;left:0px;max-width: none;";n.DOMimg.setAttribute("style",e),n.DOMimg.addEventListener("dragstart",function(e){return e.preventDefault(),!1}),n.imageW=n.sprite.width/n.tilesX,n.imageH=n.sprite.height/n.tilesY,e="width:"+n.imageW+"px;height:"+n.imageH+"px;position:fixed;top:"+n.imageY+"px;left:"+n.imageX+"px;transform:rotatey(0deg);cursor:move;z-index:2000;overflow:hidden;",n.DOMdiv.setAttribute("style",e),n.DOMdiv.appendChild(n.DOMimg),n.isChild?n._spawnChild():n._spawnESheep()}),this.sprite.src="data:image/png;base64,"+t.getElementsByTagName("png")[0].textContent,this.DOMimg.setAttribute("src",this.sprite.src),this.DOMdiv.addEventListener("mousemove",function(e){if(!n.dragging&&1==e.buttons&&0==e.button){n.dragging=!0,n.HTMLelement=null;for(var t=n.xmlDoc.getElementsByTagName("animations")[0].getElementsByTagName("animation"),i=0;i<t.length;i++)if("drag"==t[i].getElementsByTagName("name")[0].textContent){n.animationId=t[i].getAttribute("id"),n.animationStep=0,n.animationNode=t[i];break}}}),document.body.addEventListener("mousemove",function(e){n.dragging&&(n.imageX=parseInt(e.clientX)-n.imageW/2,n.imageY=parseInt(e.clientY)-n.imageH/2,n.DOMdiv.style.left=n.imageX+"px",n.DOMdiv.style.top=n.imageY+"px",n.DOMinfo.style.left=parseInt(n.imageX+n.imageW/2)+"px",n.DOMinfo.style.top=n.imageY+"px")}),document.body.addEventListener("resize",function(){n.screenW=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n.screenH=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n.imageY+n.imageH>n.screenH&&(n.imageY=n.screenH-n.imageH,n.DOMdiv.style.top=n.imageY+"px"),n.imageX+n.imageW>n.screenW&&(n.imageX=n.screenW-n.imageW,n.DOMdiv.style.left=n.imageX+"px")}),this.DOMdiv.addEventListener("contextmenu",function(e){return e.preventDefault(),!1}),this.DOMdiv.addEventListener("mouseup",function(e){n.dragging?n.dragging=!1:n.infobox?(n.DOMinfo.Hide(),n.infobox=!1):"yes"===n.userOptions.allowPopup&&(n.DOMinfo.style.left=Math.min(n.screenW-n.imageW,Math.max(n.imageW,parseInt(n.imageX+n.imageW/2)))+"px",n.DOMinfo.style.top=parseInt(n.imageY)+"px",n.DOMinfo.Show(),n.infobox=!0)}),this.DOMinfo.addEventListener("mouseup",function(e){n.DOMinfo.Hide(),n.infobox=!1});this.DOMinfo.setAttribute("style","width:200px;height:100px;transform:translate(-50%, -50%) scale(0.1);position:fixed;top:100px;left:10px;display:none;border-width:2px;border-radius:5px;border-style:ridge;border-color:#0000ab;text-align:center;text-shadow: 1px 1px 3px #ffff88;box-shadow: 3px 3px 10px #888888;color:black;opacity:0.9;z-index:9999;overflow:auto;transition:transform 0.3s ease;background: linear-gradient(to bottom right, rgba(128,128,255,0.7), rgba(200,200,255,0.4));");var i=this.xmlDoc.getElementsByTagName("header")[0],a=document.createElement("b").appendChild(document.createTextNode(i.getElementsByTagName("title")[0].textContent)),s=document.createElement("sup"),o=document.createElement("a"),r=document.createElement("p");s.appendChild(document.createTextNode("App v."+VERSION)),s.appendChild(document.createElement("br")),s.appendChild(document.createTextNode("Pet v."+i.getElementsByTagName("version")[0].textContent)),s.setAttribute("style","float:right;text-align:right;"),o.appendChild(document.createTextNode("üè†")),o.setAttribute("href","https://github.com/Adrianotiger/web-esheep"),o.setAttribute("target","_blank"),o.setAttribute("style","float:left"),r.appendChild(document.createTextNode(i.getElementsByTagName("info")[0].textContent)),r.setAttribute("style","font-size:"+(100-parseInt(i.getElementsByTagName("info")[0].textContent.length/10))+"%;"),this.DOMinfo.appendChild(s),this.DOMinfo.appendChild(o),"none"!==this.userOptions.allowPets&&((o=document.createElement("a")).appendChild(document.createTextNode("‚öô")),o.setAttribute("href","javascript:;"),o.setAttribute("style","float:left"),this.DOMinfo.appendChild(o),setTimeout(function(){n._loadPetList(o)},100)),this.DOMinfo.appendChild(a),this.DOMinfo.appendChild(document.createElement("br")),this.DOMinfo.appendChild(document.createElement("hr")),this.DOMinfo.appendChild(r),document.body.appendChild(this.DOMinfo),document.body.appendChild(this.DOMdiv),this.DOMinfo.Show=function(){n.DOMinfo.style.display="block",n.DOMinfo.style.transform="translate(-50%, -100%) scale(1.0)"},this.DOMinfo.Hide=function(){n.DOMinfo.style.transform="translate(-50%, -50%) scale(0.1)",setTimeout(function(){n.DOMinfo.style.display="none"},300)}}},{key:"_setPosition",value:function(e,t,i){this.DOMdiv&&(i?(this.imageX=parseInt(e),this.imageY=parseInt(t)):(this.imageX=parseInt(this.imageX)+parseInt(e),this.imageY=parseInt(this.imageY)+parseInt(t)),this.DOMdiv.style.left=this.imageX+"px",this.DOMdiv.style.top=this.imageY+"px")}},{key:"_spawnESheep",value:function(){for(var e=this.xmlDoc.getElementsByTagName("spawns")[0].getElementsByTagName("spawn"),t=0,i=0;i<e.length;i++)t+=parseInt(e[0].getAttribute("probability"));var n=Math.random()*t;for(i=t=0;i<e.length;i++)if(n<=(t+=parseInt(e[i].getAttribute("probability")))||i==e.length-1){this._setPosition(this._parseKeyWords(e[i].getElementsByTagName("x")[0].textContent),this._parseKeyWords(e[i].getElementsByTagName("y")[0].textContent),!0),ACTIVATE_DEBUG&&console.log("Spawn: "+this.imageX+", "+this.imageY),this.animationId=e[i].getElementsByTagName("next")[0].textContent,this.animationStep=0;for(var a=this.xmlDoc.getElementsByTagName("animations")[0].getElementsByTagName("animation"),s=0;s<a.length;s++)if(a[s].getAttribute("id")==this.animationId){this.animationNode=a[s];a=this.xmlDoc.getElementsByTagName("childs")[0].getElementsByTagName("child");for(var o=0;o<a.length;o++)if(a[o].getAttribute("animationid")==this.animationId){ACTIVATE_DEBUG&&console.log("Child from Spawn");var r=new eSheep(null,!0);r.animationId=a[o].getElementsByTagName("next")[0].textContent;var m=a[o].getElementsByTagName("x")[0].textContent,l=a[o].getElementsByTagName("y")[0].textContent;r._setPosition(this._parseKeyWords(m),this._parseKeyWords(l),!0),r.Start(this.animationFile);break}break}break}this._nextESheepStep()}},{key:"_spawnChild",value:function(){for(var e=this.xmlDoc.getElementsByTagName("animations")[0].getElementsByTagName("animation"),t=0;t<e.length;t++)if(e[t].getAttribute("id")==this.animationId){this.animationNode=e[t];break}this._nextESheepStep()}},{key:"_parseKeyWords",value:function _parseKeyWords(value){value=value.replace(/screenW/g,this.screenW),value=value.replace(/screenH/g,this.screenH),value=value.replace(/areaW/g,this.screenH),value=value.replace(/areaH/g,this.screenH),value=value.replace(/imageW/g,this.imageW),value=value.replace(/imageH/g,this.imageH),value=value.replace(/random/g,100*Math.random()),value=value.replace(/randS/g,this.randS),value=value.replace(/imageX/g,this.imageX),value=value.replace(/imageY/g,this.imageY);var ret=0;try{ret=eval(value)}catch(e){console.error("Unable to parse this position: \n'"+value+"'\n Error message: \n"+e.message)}return ret}},{key:"_getNextRandomNode",value:function(e){var t=e.getElementsByTagName("next"),i=this.xmlDoc.getElementsByTagName("animations")[0].getElementsByTagName("animation"),n=0,a=!1;if(0==t.length)return this.isChild?(ACTIVATE_DEBUG&&console.log("Remove child"),document.body.removeChild(this.DOMinfo),document.body.removeChild(this.DOMdiv)):this._spawnESheep(),!1;for(var s=0;s<t.length;s++)n+=parseInt(t[s].getAttribute("probability"));var o=Math.random()*n,r=0;for(s=n=0;s<t.length;s++)if(o<=(n+=parseInt(t[s].getAttribute("probability")))){r=s;break}for(s=0;s<i.length;s++)if(i[s].getAttribute("id")==t[r].textContent){this.animationId=i[s].getAttribute("id"),this.animationStep=0,this.animationNode=i[s],a=!0;break}if(a){i=this.xmlDoc.getElementsByTagName("childs")[0].getElementsByTagName("child");for(s=0;s<i.length;s++)if(i[s].getAttribute("animationid")==this.animationId){ACTIVATE_DEBUG&&console.log("Child from Animation");var m=new eSheep(null,!0);m.animationId=i[s].getElementsByTagName("next")[0].textContent;var l=i[s].getElementsByTagName("x")[0].textContent,h=i[s].getElementsByTagName("y")[0].textContent;m._setPosition(this._parseKeyWords(l),this._parseKeyWords(h),!0),m.Start(this.animationFile);break}}return a}},{key:"_checkOverlapping",value:function(){var e,t=this.imageX,i=this.imageY+this.imageH,n=20;for(var a in this.HTMLelement&&(n=5),COLLISION_WITH)for(var s=document.body.getElementsByTagName(COLLISION_WITH[a]),o=0;o<s.length;o++)if(i>(e=s[o].getBoundingClientRect()).top-2&&i<e.top+n&&t>e.left&&t<e.right-this.imageW){var r=window.getComputedStyle(s[o]);if(""!=r.borderTopStyle&&"none"!=r.borderTopStyle&&"none"!=r.display)return s[o]}return!1}},{key:"_getNodeValue",value:function(e,t,i){if(this.animationNode&&this.animationNode.getElementsByTagName(e)){if(this.animationNode.getElementsByTagName(e)[0].getElementsByTagName(t)[0]){var n=this.animationNode.getElementsByTagName(e)[0].getElementsByTagName(t)[0].textContent;return this._parseKeyWords(n)}return i}}},{key:"_nextESheepStep",value:function(){if(!this.prepareToDie){var e,t=this._getNodeValue("start","x",0),i=this._getNodeValue("start","y",0),n=(this._getNodeValue("start","offsety",0),this._getNodeValue("start","opacity",1),this._getNodeValue("start","interval",1e3)),a=this._getNodeValue("end","x",0),s=this._getNodeValue("end","y",0),o=(this._getNodeValue("end","offsety",0),this._getNodeValue("end","interval",1),this._getNodeValue("end","interval",1e3)),r=this._parseKeyWords(this.animationNode.getElementsByTagName("sequence")[0].getAttribute("repeat")),m=this.animationNode.getElementsByTagName("sequence")[0].getAttribute("repeatfrom"),l=this.animationNode.getElementsByTagName("gravity"),h=this.animationNode.getElementsByTagName("border"),g=this.animationNode.getElementsByTagName("frame").length+(this.animationNode.getElementsByTagName("frame").length-m)*r;if(e=this.animationStep<this.animationNode.getElementsByTagName("frame").length?this.animationNode.getElementsByTagName("frame")[this.animationStep].textContent:0==m?this.animationNode.getElementsByTagName("frame")[this.animationStep%this.animationNode.getElementsByTagName("frame").length].textContent:this.animationNode.getElementsByTagName("frame")[parseInt(m)+parseInt((this.animationStep-m)%(this.animationNode.getElementsByTagName("frame").length-m))].textContent,this.DOMimg.style.left=-this.imageW*(e%this.tilesX)+"px",this.DOMimg.style.top=-this.imageH*parseInt(e/this.tilesX)+"px",this.dragging||this.infobox)return this.animationStep++,void setTimeout(this._nextESheepStep.bind(this),50);if(this.flipped&&(t=-t,a=-a),0==this.animationStep?this._setPosition(t,i,!1):this._setPosition(parseInt(t)+parseInt((a-t)*this.animationStep/g),parseInt(i)+parseInt((s-i)*this.animationStep/g),!1),this.animationStep++,this.animationStep>=g){if(this.animationNode.getElementsByTagName("action")[0])switch(this.animationNode.getElementsByTagName("action")[0].textContent){case"flip":"rotateY(0deg)"==this.DOMdiv.style.transform?(this.DOMdiv.style.transform="rotateY(180deg)",this.flipped=!0):(this.DOMdiv.style.transform="rotateY(0deg)",this.flipped=!1)}if(!this._getNextRandomNode(this.animationNode.getElementsByTagName("sequence")[0]))return}var d=!1;if(!(h&&h[0]&&h[0].getElementsByTagName("next")&&(a<0&&this.imageX<0?d=!(this.imageX=0):0<a&&this.imageX>this.screenW-this.imageW?(this.imageX=this.screenW-this.imageW,this.DOMdiv.style.left=parseInt(this.imageX)+"px",d=!0):s<0&&this.imageY<0?d=!(this.imageY=0):0<s&&this.imageY>this.screenH-this.imageH?(this.imageY=this.screenH-this.imageH,d=!0):0<s?this._checkOverlapping()&&this.imageY>this.imageH&&(this.HTMLelement=this._checkOverlapping(),this.imageY=Math.ceil(this.HTMLelement.getBoundingClientRect().top)-this.imageH,d=!0):this.HTMLelement&&(this._checkOverlapping()||(this.imageY+this.imageH>this.HTMLelement.getBoundingClientRect().top+3||this.imageY+this.imageH<this.HTMLelement.getBoundingClientRect().top-3?this.HTMLelement=null:d=(this.imageX<this.HTMLelement.getBoundingClientRect().left?this.imageX=parseInt(this.imageX+3):this.imageX=parseInt(this.imageX-3),!0),this.DOMdiv.style.left=parseInt(this.imageX)+"px")),d&&!this._getNextRandomNode(h[0]))||!d&&l&&l[0]&&l[0].getElementsByTagName("next")&&this.imageY<this.screenH-this.imageH-2&&(null==this.HTMLelement?d=!0:this._checkOverlapping()||(d=!0,this.HTMLelement=null),d&&!this._getNextRandomNode(l[0]))))return!d&&(this.imageX<-this.imageW&&a<0||this.imageX>this.screenW&&0<a||this.imageY<-this.imageH&&i<0||this.imageY>this.screenH&&0<s)?(d=!0,void(this.isChild||this._spawnESheep())):void setTimeout(this._nextESheepStep.bind(this),parseInt(n)+parseInt((o-n)*this.animationStep/g))}}},{key:"_loadPetList",value:function(o){var r=this;fetch("https://adrianotiger.github.io/web-esheep/pets/pets.json",{credentials:"same-origin",cache:"force-cache"}).then(function(e){return e.json()}).then(function(s){console.log(s),s.pets&&o.addEventListener("mouseup",function(e){e.preventDefault(),e.stopPropagation();var t=document.createElement("div");t.setAttribute("style","position:absolute;left:0px;top:20px;width:183px;height:100%;min-height:80px;background:linear-gradient(to bottom, #8080ff, #3030a1);color:yellow;"),o.parentNode.appendChild(t);function i(e){(a=document.createElement("b")).setAttribute("style","cursor:pointer;display:block;"),a.appendChild(document.createTextNode(s.pets[e].name)),a.addEventListener("click",function(){new eSheep(r.userOptions).Start("https://adrianotiger.github.io/web-esheep/pets/"+s.pets[e].file),r.remove()}),t.appendChild(a)}for(var n in s.pets){var a;i(n)}t.addEventListener("click",function(e){o.parentNode.removeChild(t)})})})}}]),eSheep}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVzaGVlcC5taW4uanMiXSwibmFtZXMiOlsiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsIkNvbnN0cnVjdG9yIiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwicHJvdG90eXBlIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJUeXBlRXJyb3IiLCJWRVJTSU9OIiwiQUNUSVZBVEVfREVCVUciLCJERUZBVUxUX1hNTCIsIkNPTExJU0lPTl9XSVRIIiwiZVNoZWVwIiwib3B0aW9ucyIsImlzQ2hpbGQiLCJ0aGlzIiwidXNlck9wdGlvbnMiLCJhbGxvd1BldHMiLCJhbGxvd1BvcHVwIiwiYW5pbWF0aW9uRmlsZSIsImlkIiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJET01kaXYiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJET01pbWciLCJET01pbmZvIiwicGFyc2VyIiwiRE9NUGFyc2VyIiwieG1sRG9jIiwicHJlcGFyZVRvRGllIiwidGlsZXNYIiwidGlsZXNZIiwiaW1hZ2VXIiwiaW1hZ2VIIiwiaW1hZ2VYIiwiaW1hZ2VZIiwiZmxpcHBlZCIsImRyYWdnaW5nIiwiaW5mb2JveCIsImFuaW1hdGlvbklkIiwiYW5pbWF0aW9uU3RlcCIsImFuaW1hdGlvbk5vZGUiLCJzcHJpdGUiLCJJbWFnZSIsIkhUTUxlbGVtZW50IiwicmFuZFMiLCJzY3JlZW5XIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudFdpZHRoIiwiYm9keSIsInNjcmVlbkgiLCJpbm5lckhlaWdodCIsImNsaWVudEhlaWdodCIsInZhbHVlIiwiYW5pbWF0aW9uIiwiYWpheCIsIlhNTEh0dHBSZXF1ZXN0Iiwic2hlZXBDbGFzcyIsIm9wZW4iLCJhZGRFdmVudExpc3RlbmVyIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsIl9wYXJzZVhNTCIsInJlc3BvbnNlVGV4dCIsImNvbnNvbGUiLCJlcnJvciIsInN0YXR1c1RleHQiLCJzZW5kIiwiX3RoaXMiLCJIaWRlIiwic2V0VGltZW91dCIsImdldEVsZW1lbnRCeUlkIiwib3V0ZXJIVE1MIiwidGV4dCIsIl90aGlzMiIsInBhcnNlRnJvbVN0cmluZyIsImltYWdlIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJ0ZXh0Q29udGVudCIsImxvZyIsImF0dHJpYnV0ZSIsIndpZHRoIiwiaGVpZ2h0IiwiZSIsInByZXZlbnREZWZhdWx0IiwiYXBwZW5kQ2hpbGQiLCJfc3Bhd25DaGlsZCIsIl9zcGF3bkVTaGVlcCIsInNyYyIsImJ1dHRvbnMiLCJidXR0b24iLCJjaGlsZHMiLCJrIiwiZ2V0QXR0cmlidXRlIiwicGFyc2VJbnQiLCJjbGllbnRYIiwiY2xpZW50WSIsInN0eWxlIiwibGVmdCIsInRvcCIsIm1pbiIsIm1heCIsIlNob3ciLCJoZWFkZXJOb2RlIiwiaHRtbFQiLCJjcmVhdGVUZXh0Tm9kZSIsImh0bWxWIiwiaHRtbEwiLCJodG1sUCIsIl9sb2FkUGV0TGlzdCIsImRpc3BsYXkiLCJ0cmFuc2Zvcm0iLCJ4IiwieSIsImFic29sdXRlIiwic3Bhd25zIiwicHJvYiIsInJhbmQiLCJfc2V0UG9zaXRpb24iLCJfcGFyc2VLZXlXb3JkcyIsImoiLCJlU2hlZXBDaGlsZCIsIlN0YXJ0IiwiX25leHRFU2hlZXBTdGVwIiwicmVwbGFjZSIsInJldCIsImV2YWwiLCJlcnIiLCJtZXNzYWdlIiwicGFyZW50Tm9kZSIsImJhc2VOb2RlIiwibm9kZUZvdW5kIiwicmVtb3ZlQ2hpbGQiLCJpbmRleCIsInJlY3QiLCJtYXJnaW4iLCJlbHMiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJyaWdodCIsImdldENvbXB1dGVkU3R5bGUiLCJib3JkZXJUb3BTdHlsZSIsIm5vZGVOYW1lIiwidmFsdWVOYW1lIiwiZGVmYXVsdFZhbHVlIiwieDEiLCJfZ2V0Tm9kZVZhbHVlIiwieTEiLCJkZWwxIiwieDIiLCJ5MiIsImRlbDIiLCJyZXBlYXQiLCJyZXBlYXRmcm9tIiwiZ3Jhdml0eSIsImJvcmRlciIsInN0ZXBzIiwiYmluZCIsIl9nZXROZXh0UmFuZG9tTm9kZSIsInNldE5leHQiLCJfY2hlY2tPdmVybGFwcGluZyIsImNlaWwiLCJlbGVtZW50IiwiX3RoaXMzIiwiZmV0Y2giLCJjcmVkZW50aWFscyIsImNhY2hlIiwidGhlbiIsInJlc3BvbnNlIiwianNvbiIsInBldHMiLCJzdG9wUHJvcGFnYXRpb24iLCJkaXYiLCJfbG9vcCIsInBldCIsIm5hbWUiLCJmaWxlIiwicmVtb3ZlIl0sIm1hcHBpbmdzIjoiQUFBQSxhQUVBLElBQUlBLGFBQWUsV0FBYyxTQUFTQyxFQUFpQkMsRUFBUUMsR0FBUyxJQUFLLElBQUlDLEVBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLElBQUlFLEVBQWFILEVBQU1DLEdBQUlFLEVBQVdDLFdBQWFELEVBQVdDLGFBQWMsRUFBT0QsRUFBV0UsY0FBZSxFQUFVLFVBQVdGLElBQVlBLEVBQVdHLFVBQVcsR0FBTUMsT0FBT0MsZUFBZVQsRUFBUUksRUFBV00sSUFBS04sSUFBaUIsT0FBTyxTQUFVTyxFQUFhQyxFQUFZQyxHQUFpSixPQUE5SEQsR0FBWWIsRUFBaUJZLEVBQVlHLFVBQVdGLEdBQWlCQyxHQUFhZCxFQUFpQlksRUFBYUUsR0FBcUJGLEdBQTdnQixHQUVuQixTQUFTSSxnQkFBZ0JDLEVBQVVMLEdBQWUsS0FBTUssYUFBb0JMLEdBQWdCLE1BQU0sSUFBSU0sVUFBVSxxQ0E2RGhILElBQUlDLFFBQVUsUUFDVkMsZ0JBQWlCLEVBQ2pCQyxZQUFjLHlFQUNkQyxlQUFpQixDQUFDLE1BQU8sTUFRekJDLE9BQVMsV0FLWCxTQUFTQSxPQUFPQyxFQUFTQyxHQUN2QlQsZ0JBQWdCVSxLQUFNSCxRQUV0QkcsS0FBS0MsWUFB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LGlDQUMxQndKLEVBQUl4RixZQUFZbEUsU0FBU3NGLGVBQWUrRCxFQUFLQyxLQUFLN0UsR0FBR2tGLE9BQ3JERCxFQUFJbEgsaUJBQWlCLFFBQVMsV0FDcEIsSUFBSXRELE9BQU82SixFQUFPekosYUFDeEJpSCxNQUFNLGtEQUFvRDhDLEVBQUtDLEtBQUs3RSxHQUFHbUYsTUFDekViLEVBQU9jLFdBRVRMLEVBQUl0RixZQUFZd0YsR0FHbEIsSUFBSyxJQUFJakYsS0FBSzRFLEVBQUtDLEtBQU0sQ0FDdkIsSUFBSUksRUFFSkQsRUFBTWhGLEdBR1IrRSxFQUFJaEgsaUJBQWlCLFFBQVMsU0FBVXdCLEdBQ3RDOEUsRUFBUWhDLFdBQVdHLFlBQVl1QyxhQVFwQ3RLLE9BcHFCSSIsImZpbGUiOiJlc2hlZXAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qXHJcbiAqIFByb2plY3Q6XHJcbiAqICAgICAgICAgICAgICAgIGVTaGVlcCAtIFdlYnBhZ2VcclxuICpcclxuICogRGF0ZTpcclxuICogICAgICAgICAgICAgICAgMDQuYXByaWwgMjAxOFxyXG4gKlxyXG4gKiBBdXRob3I6XHJcbiAqICAgICAgICAgICAgICAgIEFkcmlhbm8gUGV0cnVjY2kgKGh0dHA6Ly9lc2hlZXAucGV0cnVjY2kuY2gpXHJcbiAqXHJcbiAqIFZlcnNpb246ICAgICAgIDAuOS4wXHJcbiAqXHJcbiAqIEludHJvZHVjdGlvbjpcclxuICogICAgICAgICAgICAgICAgQXMgXCJ3cmFwcGVyXCIgZm9yIHRoZSBPcGVuU291cmNlIEMjIHByb2plY3RcclxuICogICAgICAgICAgICAgICAgKHNlZSBodHRwczovL2dpdGh1Yi5jb20vQWRyaWFub3RpZ2VyL2Rlc2t0b3BQZXQpLFxyXG4gKiAgICAgICAgICAgICAgICB0aGlzIGphdmFzY3JpcHQgXCJjbGFzc1wiIHdhcyB3cml0dGVuIHRvIGdldCB0aGUgYW5pbWF0aW9ucyBhbHNvIGluc2lkZSB5b3VyXHJcbiAqICAgICAgICAgICAgICAgIHdlYnBhZ2UuIEl0IGRvZXNuJ3Qgd29yayBsaWtlIHRoZSBXaW5kb3dzIHZlcnNpb24sIGJ1dCBzaG93IG11Y2ggYW5pbWF0aW9ucyBmcm9tIGl0LlxyXG4gKlxyXG4gKiBEZXNjcmlwdGlvbjpcclxuICogICAgICAgICAgICAgICAgQWRkIGEgd2Fsa2luZyBwZXQgKHNoZWVwIHRvIHlvdXIgaG9tZSBwYWdlKSB3aXRoIGp1c3QgYSBmZXcgbGluZXMgb2YgY29kZSFcclxuICogICAgICAgICAgICAgICAgV2lsbCBhZGQgYSBsb3ZlbHkgc2hlZXAgKHN0cmF5IHNoZWVwKSBhbmQgdGhpcyB3aWxsIHdhbGsgYXJvdW5kIHlvdXIgcGFnZSBhbmQgb3ZlclxyXG4gKiAgICAgICAgICAgICAgICBhbGwgPGhyPnMgYW5kIDxkaXY+cyB3aXRoIGEgYm9yZGVyLiBZb3UgY2FuIGFsc28gc2VsZWN0IGFub3RoZXIgYW5pbWF0aW9uLCB1c2luZyB5b3VyXHJcbiAqICAgICAgICAgICAgICAgIHBlcnNvbmFsIFhNTCBmaWxlIG9yIG9uZSBmcm9tIHRoZSBkYXRhYmFzZS5cclxuICpcclxuICogSG93IHRvIHVzZTpcclxuICogICAgICAgICAgICAgICAgQWRkIHRoaXMgbGluZSBpbiB5b3VyIDxoZWFkZXI+OlxyXG4gKiAgICAgICAgICAgICAgICA8c2NyaXB0IHNyYz1cImh0dHBzOi8vYWRyaWFub3RpZ2VyLmdpdGh1Yi5pby93ZWItZXNoZWVwL3NyYy9lc2hlZXAuanNcIj48L3NjcmlwdD5cclxuICogICAgICAgICAgICAgICAgQWRkIHRoaXMgbGluZXMgaW4geW91ciA8Ym9keT4gKGF0IHRoZSBlbmQgaWYgcG9zc2libGUpOlxyXG4gKiAgICAgICAgICAgICAgICA8c2NyaXB0PlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwZXQgPSBuZXcgZVNoZWVwKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGV0LlN0YXJ0KCk7XHJcbiAgICAgICAgICAgICAgICAgIDwvc2NyaXB0PlxyXG4gKiAgICAgICAgICAgICAgICBUaGF0J3MgYWxsIVxyXG4gKlxyXG4gKiBSZXF1aXJlbWVudDpcclxuICogICAgICAgICAgICAgICAgVGVzdGVkIG9uIElFMTEsIEVkZ2UgYW5kIE9wZXJhXHJcbiAqXHJcbiAqIENoYW5nZWxvZzpcclxuICogICAgICAgICAgICAgICAgVmVyc2lvbiAwLjkuMCAtIDExLjA3LjIwMTk6XHJcbiAqICAgICAgICAgICAgICAgICAgLSBVcGRhdGVkIGFuaW1hdGlvbiBsaW5rIHRvIHRoZSBtYWluIHByb2plY3QgYW5pbWF0aW9uXHJcbiAqICAgICAgICAgICAgICAgICAgLSBSZWNvbXBpbGVkIHdpdGggbmV3IFlhcm4gdmVyc2lvbiAoc2VjdXJpdHkgdnVsbmVyYWJpbGl0eSlcclxuICogICAgICAgICAgICAgICAgVmVyc2lvbiAwLjguMCAtIDI5LjA1LjIwMTg6XHJcbiAqICAgICAgICAgICAgICAgICAgLSBNb3ZlZCBhbmltYXRpb24gZmlsZXMgdG8gZ2l0aHViXHJcbiAqICAgICAgICAgICAgICAgICAgLSBBZGRlZCBvcHRpb25zIHRvIHRoZSBzY3JpcHQgXHJcbiAqICAgICAgICAgICAgICAgICAgLSBMb2FkIGFuIGFuaW1hdGlvbiBmcm9tIHRoZSBHaXRIdWIgYW5pbWF0aW9ucyBmcm9tIHRoZSBwb3B1cCB3aW5kb3dcclxuICogICAgICAgICAgICAgICAgVmVyc2lvbiAwLjcuMSAtIDA0LjA0LjIwMTg6XHJcbiAqICAgICAgICAgICAgICAgICAgLSBBZGQgbWF4LXdpZHRoOiBub25lIHRvIGVuc3VyZSB0aGUgaW1hZ2UgaXMgcHJvcGVybHkgc2hvd25cclxuICogICAgICAgICAgICAgICAgVmVyc2lvbiAwLjcgLSAxMy4xMS4yMDE3OlxyXG4gKiAgICAgICAgICAgICAgICAgIC0gYmV0dGVyIEphdmFzY3JpcHQgc3RydWN0dXJlXHJcbiAqICAgICAgICAgICAgICAgICAgLSBHaXRIdWIgdmVyc2lvbiAoaHR0cHM6Ly9naXRodWIuY29tL0Fkcmlhbm90aWdlci93ZWItZXNoZWVwKVxyXG4gKiAgICAgICAgICAgICAgICAgIC0gQ2hpbGRzIGFuaW1hdGlvbnMgYWRkZWRcclxuICogICAgICAgICAgICAgICAgICAtIEJldHRlciBjb21tZW50c1xyXG4gKiAgICAgICAgICAgICAgICAgIC0gUmVwbGFjZWQgYWxlcnRzIHdpdGggY29uc29sZS5lcnJvclxyXG4gKiAgICAgICAgICAgICAgICBWZXJzaW9uIDAuNSAtIDEyLjA3LjIwMTc6XHJcbiAqICAgICAgICAgICAgICAgICAgLSBhbmltYXRpb25zIHN0YXJ0cyBvbmx5IG9uY2UgdGhlIGltYWdlIHdhcyBsb2FkZWQgKHRoYW5rcyBSZWRTcGFycjB3KVxyXG4gKiAgICAgICAgICAgICAgICBWZXJzaW9uIDAueDpcclxuICogICAgICAgICAgICAgICAgICAtIHN0aWxsIGJldGEgdmVyc2lvbnMuLi5cclxuICovXG5cbnZhciBWRVJTSU9OID0gJzAuOC4wJzsgLy8gd2ViIGVTaGVlcCB2ZXJzaW9uXG52YXIgQUNUSVZBVEVfREVCVUcgPSBmYWxzZTsgLy8gc2hvdyBsb2cgb24gY29uc29sZVxudmFyIERFRkFVTFRfWE1MID0gXCJodHRwczovL2Fkcmlhbm90aWdlci5naXRodWIuaW8vZGVza3RvcFBldC9QZXRzL2VzaGVlcDY0L2FuaW1hdGlvbnMueG1sXCI7IC8vIGRlZmF1bHQgWE1MIGFuaW1hdGlvblxudmFyIENPTExJU0lPTl9XSVRIID0gW1wiZGl2XCIsIFwiaHJcIl07IC8vIGVsZW1lbnRzIG9uIHBhZ2UgdG8gZGV0ZWN0IGZvciBjb2xsaXNpb25zXG5cbi8qXHJcbiAqIGVTaGVlcCBjbGFzcy5cclxuICogQ3JlYXRlIGEgbmV3IGNsYXNzIG9mIHRoaXMgdHlwZSBpZiB5b3Ugd2FudCBhIG5ldyBwZXQuIFdpbGwgY3JlYXRlIHRoZSBjb21wb25lbnRzIGZvciB0aGUgcGV0LlxyXG4gKiBPbmNlIGNyZWF0ZWQsIHlvdSBjYW4gY2FsbCBbdmFyaWFibGVOYW1lXS5TdGFydCgpIHRvIHN0YXJ0IHRoZSBhbmltYXRpb24gd2l0aCB5b3VyIGRlc2lyZWQgcGV0LlxyXG4gKi9cblxudmFyIGVTaGVlcCA9IGZ1bmN0aW9uICgpIHtcbiAgLyogUGFyYW1ldGVycyBmb3Igb3B0aW9ucyBbZGVmYXVsdF06XHJcbiAgICogLSBhbGxvd1BldHM6IFtub25lXSwgYWxsXHJcbiAgICogLSBhbGxvd1BvcHVwOiBbeWVzXSwgbm9cclxuICAgKi9cbiAgZnVuY3Rpb24gZVNoZWVwKG9wdGlvbnMsIGlzQ2hpbGQpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgZVNoZWVwKTtcblxuICAgIHRoaXMudXNlck9wdGlvbnMgPSBvcHRpb25zID8gb3B0aW9ucyA6IHsgYWxsb3dQZXRzOiBcIm5vbmVcIiwgYWxsb3dQb3B1cDogXCJ5ZXNcIiB9O1xuICAgIGlmICghdGhpcy51c2VyT3B0aW9ucy5hbGxvd1BvcHVwKSB0aGlzLnVzZXJPcHRpb25zLmFsbG93UG9wdXAgPSBcInllc1wiO1xuICAgIGlmICghdGhpcy51c2VyT3B0aW9ucy5hbGxvd1BldHMpIHRoaXMudXNlck9wdGlvbnMuYWxsb3dQZXRzID0gXCJub25lXCI7XG5cbiAgICAvLyBDT1JTOiBDcm9zcyBjYWxscyBhcmUgbm90IGFjY2VwdGVkIGJ5IG5ldyBicm93c2Vycy5cbiAgICB0aGlzLmFuaW1hdGlvbkZpbGUgPSBERUZBVUxUX1hNTDtcblxuICAgIHRoaXMuaWQgPSBEYXRlLm5vdygpICsgTWF0aC5yYW5kb20oKTtcblxuICAgIHRoaXMuRE9NZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTsgLy8gRGl2IGFkZGVkIHRvIHdlYnBhZ2UsIGNvbnRhaW5pbmcgdGhlIHNoZWVwXG4gICAgdGhpcy5ET01kaXYuc2V0QXR0cmlidXRlKFwiaWRcIiwgdGhpcy5pZCk7XG4gICAgdGhpcy5ET01pbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpOyAvLyBUaWxlIGltYWdlLCB3aWxsIGJlIHBvc2l0aW9uZWQgaW5zaWRlIHRoZSBkaXZcbiAgICB0aGlzLkRPTWluZm8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpOyAvLyBhYm91dCBkaWFsb2csIGlmIHlvdSBwcmVzcyBvbiB0aGUgc2hlZXBcblxuICAgIHRoaXMucGFyc2VyID0gbmV3IERPTVBhcnNlcigpOyAvLyBYTUwgcGFyc2VyXG4gICAgdGhpcy54bWxEb2MgPSBudWxsOyAvLyBwYXJzZWQgWE1MIERvY3VtZW50XG4gICAgdGhpcy5wcmVwYXJlVG9EaWUgPSBmYWxzZTsgLy8gd2hlbiByZW1vdmVkLCBhbmltYXRpb25zIHNob3VsZCBiZSBzdG9wcGVkXG5cbiAgICB0aGlzLmlzQ2hpbGQgPSBpc0NoaWxkICE9IG51bGw7IC8vIENoaWxkIHdpbGwgYmUgcmVtb3ZlZCBvbmNlIHRoZXkgcmVhY2hlZCB0aGUgZW5kXG5cbiAgICB0aGlzLnRpbGVzWCA9IDE7IC8vIFF1YW50aXR5IG9mIGltYWdlcyBpbnNpZGUgVGlsZVxuICAgIHRoaXMudGlsZXNZID0gMTsgLy8gUXVhbnRpdHkgb2YgaW1hZ2VzIGluc2lkZSBUaWxlXG4gICAgdGhpcy5pbWFnZVcgPSAxOyAvLyBXaWR0aCBvZiB0aGUgc3ByaXRlIGltYWdlXG4gICAgdGhpcy5pbWFnZUggPSAxOyAvLyBIZWlnaHQgb2YgdGhlIHNwcml0ZSBpbWFnZVxuICAgIHRoaXMuaW1hZ2VYID0gMTsgLy8gUG9zaXRpb24gb2Ygc3ByaXRlIGluc2lkZSB3ZWJwYWdlXG4gICAgdGhpcy5pbWFnZVkgPSAxOyAvLyBQb3NpdGlvbiBvZiBzcHJpdGUgaW5zaWRlIHdlYnBhZ2VcbiAgICB0aGlzLmZsaXBwZWQgPSBmYWxzZTsgLy8gaWYgc3ByaXRlIGlzIGZsaXBwZWRcbiAgICB0aGlzLmRyYWdnaW5nID0gZmFsc2U7IC8vIGlmIHVzZXIgaXMgZHJhZ2dpbmcgdGhlIHNoZWVwXG4gICAgdGhpcy5pbmZvYm94ID0gZmFsc2U7IC8vIGlmIGluZm9ib3ggaXMgdmlzaWJsZVxuICAgIHRoaXMuYW5pbWF0aW9uSWQgPSAwOyAvLyBjdXJyZW50IGFuaW1hdGlvbiBJRFxuICAgIHRoaXMuYW5pbWF0aW9uU3RlcCA9IDA7IC8vIGN1cnJlbnQgYW5pbWF0aW9uIHN0ZXBcbiAgICB0aGlzLmFuaW1hdGlvbk5vZGUgPSBudWxsOyAvLyBjdXJyZW50IGFuaW1hdGlvbiBET00gbm9kZVxuICAgIHRoaXMuc3ByaXRlID0gbmV3IEltYWdlKCk7IC8vIHNwcml0ZSBpbWFnZSAoVGlsZXMpXG4gICAgdGhpcy5IVE1MZWxlbWVudCA9IG51bGw7IC8vIHRoZSBIVE1MIGVsZW1lbnQgd2hlcmUgdGhlIHBldCBpcyB3YWxraW5nIG9uXG4gICAgdGhpcy5yYW5kUyA9IE1hdGgucmFuZG9tKCkgKiAxMDA7IC8vIHJhbmRvbSB2YWx1ZSwgd2lsbCBjaGFuZ2Ugd2hlbiBwYWdlIGlzIHJlbG9hZGVkXG5cbiAgICB0aGlzLnNjcmVlblcgPSB3aW5kb3cuaW5uZXJXaWR0aCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggfHwgZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aDsgLy8gd2luZG93IHdpZHRoXG5cbiAgICB0aGlzLnNjcmVlbkggPSB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCB8fCBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodDsgLy8gd2luZG93IGhlaWdodFxuICB9XG5cbiAgLypcclxuICAgKiBTdGFydCBuZXcgYW5pbWF0aW9uIG9uIHRoZSBwYWdlLlxyXG4gICAqIGlmIGFuaW1hdGlvbiBpcyBub3Qgc2V0LCB0aGUgZGVmYXVsdCBzaGVlcCB3aWxsIGJlIHRha2VuXHJcbiAgICovXG5cblxuICBfY3JlYXRlQ2xhc3MoZVNoZWVwLCBbe1xuICAgIGtleTogXCJTdGFydFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBTdGFydChhbmltYXRpb24pIHtcbiAgICAgIGlmICh0eXBlb2YgYW5pbWF0aW9uICE9PSAndW5kZWZpbmVkJyAmJiBhbmltYXRpb24gIT0gbnVsbCkge1xuICAgICAgICB0aGlzLmFuaW1hdGlvbkZpbGUgPSBhbmltYXRpb247XG4gICAgICB9XG5cbiAgICAgIHZhciBhamF4ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICB2YXIgc2hlZXBDbGFzcyA9IHRoaXM7XG5cbiAgICAgIGFqYXgub3BlbihcIkdFVFwiLCB0aGlzLmFuaW1hdGlvbkZpbGUsIHRydWUpO1xuICAgICAgYWpheC5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlzdGF0ZWNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT0gNCkge1xuICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PSAyMDApXG4gICAgICAgICAgICAvLyBzdWNjZXNzZnVsbHkgbG9hZGVkIFhNTCwgcGFyc2UgaXQgYW5kIGNyZWF0ZSBmaXJzdCBlc2hlZXAuXG4gICAgICAgICAgICBzaGVlcENsYXNzLl9wYXJzZVhNTCh0aGlzLnJlc3BvbnNlVGV4dCk7ZWxzZSBjb25zb2xlLmVycm9yKFwiWE1MIG5vdCBhdmFpbGFibGU6XCIgKyB0aGlzLnN0YXR1c1RleHQgKyBcIlxcblwiICsgdGhpcy5yZXNwb25zZVRleHQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGFqYXguc2VuZChudWxsKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVtb3ZlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgIHRoaXMucHJlcGFyZVRvRGllID0gdHJ1ZTtcbiAgICAgIHRoaXMuRE9NaW5mby5IaWRlKCk7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMuRE9NZGl2ID0gX3RoaXMuRE9NaW1nID0gX3RoaXMuRE9NaW5mbyA9IG51bGw7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKF90aGlzLmlkKS5vdXRlckhUTUwgPSAnJztcbiAgICAgIH0sIDUwMCk7XG4gICAgfVxuXG4gICAgLypcclxuICAgICAqIFBhcnNlIGxvYWRlZCBYTUwsIGNvbnRhaW5zIHNwYXduLCBhbmltYXRpb25zIGFuZCBjaGlsZHNcclxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiX3BhcnNlWE1MXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9wYXJzZVhNTCh0ZXh0KSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdGhpcy54bWxEb2MgPSB0aGlzLnBhcnNlci5wYXJzZUZyb21TdHJpbmcodGV4dCwgJ3RleHQveG1sJyk7XG4gICAgICB2YXIgaW1hZ2UgPSB0aGlzLnhtbERvYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW1hZ2UnKVswXTtcbiAgICAgIHRoaXMudGlsZXNYID0gaW1hZ2UuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0aWxlc3hcIilbMF0udGV4dENvbnRlbnQ7XG4gICAgICB0aGlzLnRpbGVzWSA9IGltYWdlLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidGlsZXN5XCIpWzBdLnRleHRDb250ZW50O1xuICAgICAgLy8gRXZlbnQgbGlzdGVuZXI6IFNwcml0ZSB3YXMgbG9hZGVkID0+XG4gICAgICAvLyAgIHBsYXkgYW5pbWF0aW9uIG9ubHkgd2hlbiB0aGUgc3ByaXRlIGlzIGxvYWRlZFxuICAgICAgdGhpcy5zcHJpdGUuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoQUNUSVZBVEVfREVCVUcpIGNvbnNvbGUubG9nKFwiU3ByaXRlIGltYWdlIGxvYWRlZFwiKTtcbiAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IFwid2lkdGg6XCIgKyBfdGhpczIuc3ByaXRlLndpZHRoICsgXCJweDtcIiArIFwiaGVpZ2h0OlwiICsgX3RoaXMyLnNwcml0ZS5oZWlnaHQgKyBcInB4O1wiICsgXCJwb3NpdGlvbjphYnNvbHV0ZTtcIiArIFwidG9wOjBweDtcIiArIFwibGVmdDowcHg7XCIgKyBcIm1heC13aWR0aDogbm9uZTtcIjtcbiAgICAgICAgX3RoaXMyLkRPTWltZy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBhdHRyaWJ1dGUpO1xuICAgICAgICAvLyBwcmV2ZW50IHRvIG1vdmUgaW1hZ2UgKHdpbGwgc2hvdyB0aGUgZW50aXJlIHNwcml0ZSBzaGVldCBpZiBub3QgY2F0Y2hlZClcbiAgICAgICAgX3RoaXMyLkRPTWltZy5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO3JldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIF90aGlzMi5pbWFnZVcgPSBfdGhpczIuc3ByaXRlLndpZHRoIC8gX3RoaXMyLnRpbGVzWDtcbiAgICAgICAgX3RoaXMyLmltYWdlSCA9IF90aGlzMi5zcHJpdGUuaGVpZ2h0IC8gX3RoaXMyLnRpbGVzWTtcbiAgICAgICAgYXR0cmlidXRlID0gXCJ3aWR0aDpcIiArIF90aGlzMi5pbWFnZVcgKyBcInB4O1wiICsgXCJoZWlnaHQ6XCIgKyBfdGhpczIuaW1hZ2VIICsgXCJweDtcIiArIFwicG9zaXRpb246Zml4ZWQ7XCIgKyBcInRvcDpcIiArIF90aGlzMi5pbWFnZVkgKyBcInB4O1wiICsgXCJsZWZ0OlwiICsgX3RoaXMyLmltYWdlWCArIFwicHg7XCIgKyBcInRyYW5zZm9ybTpyb3RhdGV5KDBkZWcpO1wiICsgXCJjdXJzb3I6bW92ZTtcIiArIFwiei1pbmRleDoyMDAwO1wiICsgXCJvdmVyZmxvdzpoaWRkZW47XCI7XG4gICAgICAgIF90aGlzMi5ET01kaXYuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgYXR0cmlidXRlKTtcbiAgICAgICAgX3RoaXMyLkRPTWRpdi5hcHBlbmRDaGlsZChfdGhpczIuRE9NaW1nKTtcblxuICAgICAgICBpZiAoX3RoaXMyLmlzQ2hpbGQpIF90aGlzMi5fc3Bhd25DaGlsZCgpO2Vsc2UgX3RoaXMyLl9zcGF3bkVTaGVlcCgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuc3ByaXRlLnNyYyA9ICdkYXRhOmltYWdlL3BuZztiYXNlNjQsJyArIGltYWdlLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwicG5nXCIpWzBdLnRleHRDb250ZW50O1xuICAgICAgdGhpcy5ET01pbWcuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMuc3ByaXRlLnNyYyk7XG5cbiAgICAgIC8vIE1vdXNlIG1vdmUgb3ZlciBlU2hlZXAsIGNoZWNrIGlmIGVTaGVlcCBzaG91bGQgYmUgbW92ZWQgb3ZlciB0aGUgc2NyZWVuXG4gICAgICB0aGlzLkRPTWRpdi5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICghX3RoaXMyLmRyYWdnaW5nICYmIGUuYnV0dG9ucyA9PSAxICYmIGUuYnV0dG9uID09IDApIHtcbiAgICAgICAgICBfdGhpczIuZHJhZ2dpbmcgPSB0cnVlO1xuICAgICAgICAgIF90aGlzMi5IVE1MZWxlbWVudCA9IG51bGw7XG4gICAgICAgICAgdmFyIGNoaWxkc1Jvb3QgPSBfdGhpczIueG1sRG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdhbmltYXRpb25zJylbMF07XG4gICAgICAgICAgdmFyIGNoaWxkcyA9IGNoaWxkc1Jvb3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2FuaW1hdGlvbicpO1xuICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY2hpbGRzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICBpZiAoY2hpbGRzW2tdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCduYW1lJylbMF0udGV4dENvbnRlbnQgPT0gXCJkcmFnXCIpIHtcbiAgICAgICAgICAgICAgX3RoaXMyLmFuaW1hdGlvbklkID0gY2hpbGRzW2tdLmdldEF0dHJpYnV0ZShcImlkXCIpO1xuICAgICAgICAgICAgICBfdGhpczIuYW5pbWF0aW9uU3RlcCA9IDA7XG4gICAgICAgICAgICAgIF90aGlzMi5hbmltYXRpb25Ob2RlID0gY2hpbGRzW2tdO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVyIHRvIGJvZHksIGlmIG1vdXNlIG1vdmVkIHRvbyBmYXN0IG92ZXIgdGhlIGRyYWdnaW5nIGVTaGVlcFxuICAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmIChfdGhpczIuZHJhZ2dpbmcpIHtcbiAgICAgICAgICBfdGhpczIuaW1hZ2VYID0gcGFyc2VJbnQoZS5jbGllbnRYKSAtIF90aGlzMi5pbWFnZVcgLyAyO1xuICAgICAgICAgIF90aGlzMi5pbWFnZVkgPSBwYXJzZUludChlLmNsaWVudFkpIC0gX3RoaXMyLmltYWdlSCAvIDI7XG5cbiAgICAgICAgICBfdGhpczIuRE9NZGl2LnN0eWxlLmxlZnQgPSBfdGhpczIuaW1hZ2VYICsgXCJweFwiO1xuICAgICAgICAgIF90aGlzMi5ET01kaXYuc3R5bGUudG9wID0gX3RoaXMyLmltYWdlWSArIFwicHhcIjtcbiAgICAgICAgICBfdGhpczIuRE9NaW5mby5zdHlsZS5sZWZ0ID0gcGFyc2VJbnQoX3RoaXMyLmltYWdlWCArIF90aGlzMi5pbWFnZVcgLyAyKSArIFwicHhcIjtcbiAgICAgICAgICBfdGhpczIuRE9NaW5mby5zdHlsZS50b3AgPSBfdGhpczIuaW1hZ2VZICsgXCJweFwiO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIC8vIFdpbmRvdyByZXNpemVkLCByZWNhbGN1bGF0ZSBlU2hlZXAgYm91bmRzXG4gICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczIuc2NyZWVuVyA9IHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCB8fCBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoO1xuXG4gICAgICAgIF90aGlzMi5zY3JlZW5IID0gd2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgfHwgZG9jdW1lbnQuYm9keS5jbGllbnRIZWlnaHQ7XG5cbiAgICAgICAgaWYgKF90aGlzMi5pbWFnZVkgKyBfdGhpczIuaW1hZ2VIID4gX3RoaXMyLnNjcmVlbkgpIHtcbiAgICAgICAgICBfdGhpczIuaW1hZ2VZID0gX3RoaXMyLnNjcmVlbkggLSBfdGhpczIuaW1hZ2VIO1xuICAgICAgICAgIF90aGlzMi5ET01kaXYuc3R5bGUudG9wID0gX3RoaXMyLmltYWdlWSArIFwicHhcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoX3RoaXMyLmltYWdlWCArIF90aGlzMi5pbWFnZVcgPiBfdGhpczIuc2NyZWVuVykge1xuICAgICAgICAgIF90aGlzMi5pbWFnZVggPSBfdGhpczIuc2NyZWVuVyAtIF90aGlzMi5pbWFnZVc7XG4gICAgICAgICAgX3RoaXMyLkRPTWRpdi5zdHlsZS5sZWZ0ID0gX3RoaXMyLmltYWdlWCArIFwicHhcIjtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICAvLyBEb24ndCBhbGxvdyBjb250ZXh0bWVudSBvdmVyIHRoZSBzaGVlcFxuICAgICAgdGhpcy5ET01kaXYuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSk7XG4gICAgICAvLyBNb3VzZSByZWxlYXNlZFxuICAgICAgdGhpcy5ET01kaXYuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKF90aGlzMi5kcmFnZ2luZykge1xuICAgICAgICAgIF90aGlzMi5kcmFnZ2luZyA9IGZhbHNlO1xuICAgICAgICB9IGVsc2UgaWYgKF90aGlzMi5pbmZvYm94KSB7XG4gICAgICAgICAgX3RoaXMyLkRPTWluZm8uSGlkZSgpO1xuICAgICAgICAgIF90aGlzMi5pbmZvYm94ID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKF90aGlzMi51c2VyT3B0aW9ucy5hbGxvd1BvcHVwID09PSBcInllc1wiKSB7XG4gICAgICAgICAgICBfdGhpczIuRE9NaW5mby5zdHlsZS5sZWZ0ID0gTWF0aC5taW4oX3RoaXMyLnNjcmVlblcgLSBfdGhpczIuaW1hZ2VXLCBNYXRoLm1heChfdGhpczIuaW1hZ2VXLCBwYXJzZUludChfdGhpczIuaW1hZ2VYICsgX3RoaXMyLmltYWdlVyAvIDIpKSkgKyBcInB4XCI7XG4gICAgICAgICAgICBfdGhpczIuRE9NaW5mby5zdHlsZS50b3AgPSBwYXJzZUludChfdGhpczIuaW1hZ2VZKSArIFwicHhcIjtcbiAgICAgICAgICAgIF90aGlzMi5ET01pbmZvLlNob3coKTtcbiAgICAgICAgICAgIF90aGlzMi5pbmZvYm94ID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLy8gTW91c2UgcmVsZWFzZWQgb3ZlciB0aGUgaW5mbyBib3hcbiAgICAgIHRoaXMuRE9NaW5mby5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBfdGhpczIuRE9NaW5mby5IaWRlKCk7XG4gICAgICAgIF90aGlzMi5pbmZvYm94ID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICAgIC8vIENyZWF0ZSBBYm91dCBib3hcbiAgICAgIHZhciBhdHRyaWJ1dGUgPSBcIndpZHRoOjIwMHB4O1wiICsgXCJoZWlnaHQ6MTAwcHg7XCIgKyBcInRyYW5zZm9ybTp0cmFuc2xhdGUoLTUwJSwgLTUwJSkgc2NhbGUoMC4xKTtcIiArIFwicG9zaXRpb246Zml4ZWQ7XCIgKyBcInRvcDoxMDBweDtsZWZ0OjEwcHg7XCIgKyBcImRpc3BsYXk6bm9uZTtcIiArIFwiYm9yZGVyLXdpZHRoOjJweDtcIiArIFwiYm9yZGVyLXJhZGl1czo1cHg7XCIgKyBcImJvcmRlci1zdHlsZTpyaWRnZTtcIiArIFwiYm9yZGVyLWNvbG9yOiMwMDAwYWI7XCIgKyBcInRleHQtYWxpZ246Y2VudGVyO1wiICsgXCJ0ZXh0LXNoYWRvdzogMXB4IDFweCAzcHggI2ZmZmY4ODtcIiArIFwiYm94LXNoYWRvdzogM3B4IDNweCAxMHB4ICM4ODg4ODg7XCIgKyBcImNvbG9yOmJsYWNrO1wiICsgXCJvcGFjaXR5OjAuOTtcIiArIFwiei1pbmRleDo5OTk5O1wiICsgXCJvdmVyZmxvdzphdXRvO1wiICsgXCJ0cmFuc2l0aW9uOnRyYW5zZm9ybSAwLjNzIGVhc2U7XCIgKyBcImJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20gcmlnaHQsIHJnYmEoMTI4LDEyOCwyNTUsMC43KSwgcmdiYSgyMDAsMjAwLDI1NSwwLjQpKTtcIjtcbiAgICAgIHRoaXMuRE9NaW5mby5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBhdHRyaWJ1dGUpO1xuICAgICAgdmFyIGhlYWRlck5vZGUgPSB0aGlzLnhtbERvYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZGVyJylbMF07XG4gICAgICB2YXIgaHRtbFQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYlwiKS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShoZWFkZXJOb2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0aXRsZScpWzBdLnRleHRDb250ZW50KSk7XG4gICAgICB2YXIgaHRtbFYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3VwXCIpO1xuICAgICAgdmFyIGh0bWxMID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XG4gICAgICB2YXIgaHRtbFAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICAgIGh0bWxWLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiQXBwIHYuXCIgKyBWRVJTSU9OKSk7XG4gICAgICBodG1sVi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnJcIikpO1xuICAgICAgaHRtbFYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJQZXQgdi5cIiArIGhlYWRlck5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3ZlcnNpb24nKVswXS50ZXh0Q29udGVudCkpO1xuICAgICAgaHRtbFYuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJmbG9hdDpyaWdodDt0ZXh0LWFsaWduOnJpZ2h0O1wiKTtcbiAgICAgIGh0bWxMLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiXFx1RDgzQ1xcdURGRTBcIikpO1xuICAgICAgaHRtbEwuc2V0QXR0cmlidXRlKFwiaHJlZlwiLCBcImh0dHBzOi8vZ2l0aHViLmNvbS9BZHJpYW5vdGlnZXIvd2ViLWVzaGVlcFwiKTtcbiAgICAgIGh0bWxMLnNldEF0dHJpYnV0ZShcInRhcmdldFwiLCBcIl9ibGFua1wiKTtcbiAgICAgIGh0bWxMLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiZmxvYXQ6bGVmdFwiKTtcbiAgICAgIGh0bWxQLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGhlYWRlck5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2luZm8nKVswXS50ZXh0Q29udGVudCkpO1xuICAgICAgaHRtbFAuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJmb250LXNpemU6XCIgKyAoMTAwIC0gcGFyc2VJbnQoaGVhZGVyTm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5mbycpWzBdLnRleHRDb250ZW50Lmxlbmd0aCAvIDEwKSkgKyBcIiU7XCIpO1xuICAgICAgdGhpcy5ET01pbmZvLmFwcGVuZENoaWxkKGh0bWxWKTtcbiAgICAgIHRoaXMuRE9NaW5mby5hcHBlbmRDaGlsZChodG1sTCk7XG4gICAgICBpZiAodGhpcy51c2VyT3B0aW9ucy5hbGxvd1BldHMgIT09IFwibm9uZVwiKSB7XG4gICAgICAgIGh0bWxMID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XG4gICAgICAgIGh0bWxMLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiXFx1MjY5OVwiKSk7XG4gICAgICAgIGh0bWxMLnNldEF0dHJpYnV0ZShcImhyZWZcIiwgXCJqYXZhc2NyaXB0OjtcIik7XG4gICAgICAgIGh0bWxMLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiZmxvYXQ6bGVmdFwiKTtcbiAgICAgICAgdGhpcy5ET01pbmZvLmFwcGVuZENoaWxkKGh0bWxMKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXMyLl9sb2FkUGV0TGlzdChodG1sTCk7XG4gICAgICAgIH0sIDEwMCk7XG4gICAgICB9XG4gICAgICB0aGlzLkRPTWluZm8uYXBwZW5kQ2hpbGQoaHRtbFQpO1xuICAgICAgdGhpcy5ET01pbmZvLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKSk7XG4gICAgICB0aGlzLkRPTWluZm8uYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImhyXCIpKTtcbiAgICAgIHRoaXMuRE9NaW5mby5hcHBlbmRDaGlsZChodG1sUCk7XG4gICAgICAvLyBBZGQgYWJvdXQgYW5kIHNoZWVwIGVsZW1lbnRzIHRvIHRoZSBib2R5XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuRE9NaW5mbyk7XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuRE9NZGl2KTtcblxuICAgICAgdGhpcy5ET01pbmZvLlNob3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzMi5ET01pbmZvLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgIF90aGlzMi5ET01pbmZvLnN0eWxlLnRyYW5zZm9ybSA9IFwidHJhbnNsYXRlKC01MCUsIC0xMDAlKSBzY2FsZSgxLjApXCI7XG4gICAgICB9O1xuICAgICAgdGhpcy5ET01pbmZvLkhpZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzMi5ET01pbmZvLnN0eWxlLnRyYW5zZm9ybSA9IFwidHJhbnNsYXRlKC01MCUsIC01MCUpIHNjYWxlKDAuMSlcIjtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXMyLkRPTWluZm8uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICB9LCAzMDApO1xuICAgICAgfTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiX3NldFBvc2l0aW9uXCIsXG5cblxuICAgIC8qXHJcbiAgICAgKiBTZXQgbmV3IHBvc2l0aW9uIGZvciB0aGUgcGV0XHJcbiAgICAgKiBJZiBhYnNvbHV0ZSBpcyB0cnVlLCB0aGUgeCBhbmQgeSBjb29yZGluYXRlcyBhcmUgdXNlZCBhcyBhYnNvbHV0ZSB2YWx1ZXMuXHJcbiAgICAgKiBJZiBmYWxzZSwgeCBhbmQgeSBhcmUgYWRkZWQgdG8gdGhlIGN1cnJlbnQgcG9zaXRpb25cclxuICAgICAqL1xuICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0UG9zaXRpb24oeCwgeSwgYWJzb2x1dGUpIHtcbiAgICAgIGlmICh0aGlzLkRPTWRpdikge1xuICAgICAgICBpZiAoYWJzb2x1dGUpIHtcbiAgICAgICAgICB0aGlzLmltYWdlWCA9IHBhcnNlSW50KHgpO1xuICAgICAgICAgIHRoaXMuaW1hZ2VZID0gcGFyc2VJbnQoeSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5pbWFnZVggPSBwYXJzZUludCh0aGlzLmltYWdlWCkgKyBwYXJzZUludCh4KTtcbiAgICAgICAgICB0aGlzLmltYWdlWSA9IHBhcnNlSW50KHRoaXMuaW1hZ2VZKSArIHBhcnNlSW50KHkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuRE9NZGl2LnN0eWxlLmxlZnQgPSB0aGlzLmltYWdlWCArIFwicHhcIjtcbiAgICAgICAgdGhpcy5ET01kaXYuc3R5bGUudG9wID0gdGhpcy5pbWFnZVkgKyBcInB4XCI7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLypcclxuICAgICAqIFNwYXduIG5ldyBlc2hlZXAsIHRoaXMgaXMgY2FsbGVkIGlmIHRoZSBYTUwgd2FzIGxvYWRlZCBzdWNjZXNzZnVsbHlcclxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiX3NwYXduRVNoZWVwXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9zcGF3bkVTaGVlcCgpIHtcbiAgICAgIHZhciBzcGF3bnNSb290ID0gdGhpcy54bWxEb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NwYXducycpWzBdO1xuICAgICAgdmFyIHNwYXducyA9IHNwYXduc1Jvb3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NwYXduJyk7XG4gICAgICB2YXIgcHJvYiA9IDA7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNwYXducy5sZW5ndGg7IGkrKykge1xuICAgICAgICBwcm9iICs9IHBhcnNlSW50KHNwYXduc1swXS5nZXRBdHRyaWJ1dGUoXCJwcm9iYWJpbGl0eVwiKSk7XG4gICAgICB9dmFyIHJhbmQgPSBNYXRoLnJhbmRvbSgpICogcHJvYjtcbiAgICAgIHByb2IgPSAwO1xuICAgICAgZm9yIChpID0gMDsgaSA8IHNwYXducy5sZW5ndGg7IGkrKykge1xuICAgICAgICBwcm9iICs9IHBhcnNlSW50KHNwYXduc1tpXS5nZXRBdHRyaWJ1dGUoXCJwcm9iYWJpbGl0eVwiKSk7XG4gICAgICAgIGlmIChwcm9iID49IHJhbmQgfHwgaSA9PSBzcGF3bnMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIHRoaXMuX3NldFBvc2l0aW9uKHRoaXMuX3BhcnNlS2V5V29yZHMoc3Bhd25zW2ldLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd4JylbMF0udGV4dENvbnRlbnQpLCB0aGlzLl9wYXJzZUtleVdvcmRzKHNwYXduc1tpXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgneScpWzBdLnRleHRDb250ZW50KSwgdHJ1ZSk7XG4gICAgICAgICAgaWYgKEFDVElWQVRFX0RFQlVHKSBjb25zb2xlLmxvZyhcIlNwYXduOiBcIiArIHRoaXMuaW1hZ2VYICsgXCIsIFwiICsgdGhpcy5pbWFnZVkpO1xuICAgICAgICAgIHRoaXMuYW5pbWF0aW9uSWQgPSBzcGF3bnNbaV0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ25leHQnKVswXS50ZXh0Q29udGVudDtcbiAgICAgICAgICB0aGlzLmFuaW1hdGlvblN0ZXAgPSAwO1xuICAgICAgICAgIHZhciBjaGlsZHNSb290ID0gdGhpcy54bWxEb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2FuaW1hdGlvbnMnKVswXTtcbiAgICAgICAgICB2YXIgY2hpbGRzID0gY2hpbGRzUm9vdC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYW5pbWF0aW9uJyk7XG4gICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBjaGlsZHMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgIGlmIChjaGlsZHNba10uZ2V0QXR0cmlidXRlKFwiaWRcIikgPT0gdGhpcy5hbmltYXRpb25JZCkge1xuICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbk5vZGUgPSBjaGlsZHNba107XG5cbiAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgY2hpbGQgc2hvdWxkIGJlIGxvYWRlZCB0b2doZXRoZXIgd2l0aCB0aGlzIGFuaW1hdGlvblxuICAgICAgICAgICAgICB2YXIgY2hpbGRzUm9vdCA9IHRoaXMueG1sRG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdjaGlsZHMnKVswXTtcbiAgICAgICAgICAgICAgdmFyIGNoaWxkcyA9IGNoaWxkc1Jvb3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2NoaWxkJyk7XG4gICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY2hpbGRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkc1tqXS5nZXRBdHRyaWJ1dGUoXCJhbmltYXRpb25pZFwiKSA9PSB0aGlzLmFuaW1hdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoQUNUSVZBVEVfREVCVUcpIGNvbnNvbGUubG9nKFwiQ2hpbGQgZnJvbSBTcGF3blwiKTtcbiAgICAgICAgICAgICAgICAgIHZhciBlU2hlZXBDaGlsZCA9IG5ldyBlU2hlZXAobnVsbCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICBlU2hlZXBDaGlsZC5hbmltYXRpb25JZCA9IGNoaWxkc1tqXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbmV4dCcpWzBdLnRleHRDb250ZW50O1xuICAgICAgICAgICAgICAgICAgdmFyIHggPSBjaGlsZHNbal0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3gnKVswXS50ZXh0Q29udGVudDsgLy9cbiAgICAgICAgICAgICAgICAgIHZhciB5ID0gY2hpbGRzW2pdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd5JylbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICBlU2hlZXBDaGlsZC5fc2V0UG9zaXRpb24odGhpcy5fcGFyc2VLZXlXb3Jkcyh4KSwgdGhpcy5fcGFyc2VLZXlXb3Jkcyh5KSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAvLyBTdGFydCBhbmltYXRpb25cbiAgICAgICAgICAgICAgICAgIGVTaGVlcENoaWxkLlN0YXJ0KHRoaXMuYW5pbWF0aW9uRmlsZSk7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBQbGF5IG5leHQgc3RlcFxuICAgICAgdGhpcy5fbmV4dEVTaGVlcFN0ZXAoKTtcbiAgICB9XG5cbiAgICAvKlxyXG4gICAgICogTGlrZSBzcGF3bkVTaGVlcCwgYnV0IGZvciBDaGlsZHNcclxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiX3NwYXduQ2hpbGRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX3NwYXduQ2hpbGQoKSB7XG4gICAgICB2YXIgY2hpbGRzUm9vdCA9IHRoaXMueG1sRG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdhbmltYXRpb25zJylbMF07XG4gICAgICB2YXIgY2hpbGRzID0gY2hpbGRzUm9vdC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYW5pbWF0aW9uJyk7XG4gICAgICBmb3IgKHZhciBrID0gMDsgayA8IGNoaWxkcy5sZW5ndGg7IGsrKykge1xuICAgICAgICBpZiAoY2hpbGRzW2tdLmdldEF0dHJpYnV0ZShcImlkXCIpID09IHRoaXMuYW5pbWF0aW9uSWQpIHtcbiAgICAgICAgICB0aGlzLmFuaW1hdGlvbk5vZGUgPSBjaGlsZHNba107XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuX25leHRFU2hlZXBTdGVwKCk7XG4gICAgfVxuXG4gICAgLy8gUGFyc2UgdGhlIGh1bWFuIHJlYWRhYmxlIGV4cHJlc3Npb24gZnJvbSBYTUwgdG8gYSBjb21wdXRlciByZWFkYWJsZSBleHByZXNzaW9uXG5cbiAgfSwge1xuICAgIGtleTogXCJfcGFyc2VLZXlXb3Jkc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfcGFyc2VLZXlXb3Jkcyh2YWx1ZSkge1xuICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9zY3JlZW5XL2csIHRoaXMuc2NyZWVuVyk7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL3NjcmVlbkgvZywgdGhpcy5zY3JlZW5IKTtcbiAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvYXJlYVcvZywgdGhpcy5zY3JlZW5IKTtcbiAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvYXJlYUgvZywgdGhpcy5zY3JlZW5IKTtcbiAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvaW1hZ2VXL2csIHRoaXMuaW1hZ2VXKTtcbiAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvaW1hZ2VIL2csIHRoaXMuaW1hZ2VIKTtcbiAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvcmFuZG9tL2csIE1hdGgucmFuZG9tKCkgKiAxMDApO1xuICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9yYW5kUy9nLCB0aGlzLnJhbmRTKTtcbiAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvaW1hZ2VYL2csIHRoaXMuaW1hZ2VYKTtcbiAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvaW1hZ2VZL2csIHRoaXMuaW1hZ2VZKTtcblxuICAgICAgdmFyIHJldCA9IDA7XG4gICAgICB0cnkge1xuICAgICAgICByZXQgPSBldmFsKHZhbHVlKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIHBhcnNlIHRoaXMgcG9zaXRpb246IFxcbidcIiArIHZhbHVlICsgXCInXFxuIEVycm9yIG1lc3NhZ2U6IFxcblwiICsgZXJyLm1lc3NhZ2UpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG5cbiAgICAvKlxyXG4gICAgICogT25jZSB0aGUgYW5pbWF0aW9uIGlzIG92ZXIsIGdldCB0aGUgbmV4dCBhbmltYXRpb24gdG8gcGxheVxyXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJfZ2V0TmV4dFJhbmRvbU5vZGVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2dldE5leHRSYW5kb21Ob2RlKHBhcmVudE5vZGUpIHtcbiAgICAgIHZhciBiYXNlTm9kZSA9IHBhcmVudE5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ25leHQnKTtcbiAgICAgIHZhciBjaGlsZHNSb290ID0gdGhpcy54bWxEb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2FuaW1hdGlvbnMnKVswXTtcbiAgICAgIHZhciBjaGlsZHMgPSBjaGlsZHNSb290LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdhbmltYXRpb24nKTtcbiAgICAgIHZhciBwcm9iID0gMDtcbiAgICAgIHZhciBub2RlRm91bmQgPSBmYWxzZTtcblxuICAgICAgLy8gbm8gbW9yZSBhbmltYXRpb25zIChpdCB3YXMgdGhlIGxhc3Qgb25lKVxuICAgICAgaWYgKGJhc2VOb2RlLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgIC8vIElmIGl0IGlzIGEgY2hpbGQsIHJlbW92ZSB0aGUgY2hpbGQgZnJvbSBkb2N1bWVudFxuICAgICAgICBpZiAodGhpcy5pc0NoaWxkKSB7XG4gICAgICAgICAgLy8gcmVtb3ZlIGNoaWxkXG4gICAgICAgICAgaWYgKEFDVElWQVRFX0RFQlVHKSBjb25zb2xlLmxvZyhcIlJlbW92ZSBjaGlsZFwiKTtcbiAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRoaXMuRE9NaW5mbyk7XG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLkRPTWRpdik7XG4gICAgICAgICAgZGVsZXRlIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgLy8gZWxzZSwgc3Bhd24gc2hlZXAgYWdhaW5cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zcGF3bkVTaGVlcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBrID0gMDsgayA8IGJhc2VOb2RlLmxlbmd0aDsgaysrKSB7XG4gICAgICAgIHByb2IgKz0gcGFyc2VJbnQoYmFzZU5vZGVba10uZ2V0QXR0cmlidXRlKFwicHJvYmFiaWxpdHlcIikpO1xuICAgICAgfVxuICAgICAgdmFyIHJhbmQgPSBNYXRoLnJhbmRvbSgpICogcHJvYjtcbiAgICAgIHZhciBpbmRleCA9IDA7XG4gICAgICBwcm9iID0gMDtcbiAgICAgIGZvciAoayA9IDA7IGsgPCBiYXNlTm9kZS5sZW5ndGg7IGsrKykge1xuICAgICAgICBwcm9iICs9IHBhcnNlSW50KGJhc2VOb2RlW2tdLmdldEF0dHJpYnV0ZShcInByb2JhYmlsaXR5XCIpKTtcbiAgICAgICAgaWYgKHByb2IgPj0gcmFuZCkge1xuICAgICAgICAgIGluZGV4ID0gaztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZm9yIChrID0gMDsgayA8IGNoaWxkcy5sZW5ndGg7IGsrKykge1xuICAgICAgICBpZiAoY2hpbGRzW2tdLmdldEF0dHJpYnV0ZShcImlkXCIpID09IGJhc2VOb2RlW2luZGV4XS50ZXh0Q29udGVudCkge1xuICAgICAgICAgIHRoaXMuYW5pbWF0aW9uSWQgPSBjaGlsZHNba10uZ2V0QXR0cmlidXRlKFwiaWRcIik7XG4gICAgICAgICAgdGhpcy5hbmltYXRpb25TdGVwID0gMDtcbiAgICAgICAgICB0aGlzLmFuaW1hdGlvbk5vZGUgPSBjaGlsZHNba107XG4gICAgICAgICAgbm9kZUZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAobm9kZUZvdW5kKSAvLyBjcmVhdGUgQ2hpbGQsIGlmIHByZXNlbnRcbiAgICAgICAge1xuICAgICAgICAgIHZhciBjaGlsZHNSb290ID0gdGhpcy54bWxEb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2NoaWxkcycpWzBdO1xuICAgICAgICAgIHZhciBjaGlsZHMgPSBjaGlsZHNSb290LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdjaGlsZCcpO1xuICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBjaGlsZHMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgIGlmIChjaGlsZHNba10uZ2V0QXR0cmlidXRlKFwiYW5pbWF0aW9uaWRcIikgPT0gdGhpcy5hbmltYXRpb25JZCkge1xuICAgICAgICAgICAgICBpZiAoQUNUSVZBVEVfREVCVUcpIGNvbnNvbGUubG9nKFwiQ2hpbGQgZnJvbSBBbmltYXRpb25cIik7XG4gICAgICAgICAgICAgIHZhciBlU2hlZXBDaGlsZCA9IG5ldyBlU2hlZXAobnVsbCwgdHJ1ZSk7XG4gICAgICAgICAgICAgIGVTaGVlcENoaWxkLmFuaW1hdGlvbklkID0gY2hpbGRzW2tdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCduZXh0JylbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgICAgICAgIHZhciB4ID0gY2hpbGRzW2tdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd4JylbMF0udGV4dENvbnRlbnQ7IC8vXG4gICAgICAgICAgICAgIHZhciB5ID0gY2hpbGRzW2tdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd5JylbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgICAgICAgIGVTaGVlcENoaWxkLl9zZXRQb3NpdGlvbih0aGlzLl9wYXJzZUtleVdvcmRzKHgpLCB0aGlzLl9wYXJzZUtleVdvcmRzKHkpLCB0cnVlKTtcbiAgICAgICAgICAgICAgZVNoZWVwQ2hpbGQuU3RhcnQodGhpcy5hbmltYXRpb25GaWxlKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIHJldHVybiBub2RlRm91bmQ7XG4gICAgfVxuXG4gICAgLypcclxuICAgICAqIENoZWNrIGlmIHNoZWVwIGlzIHdhbGtpbmcgb3ZlciBhIGRlZmluZWQgSFRNTCBUQUctZWxlbWVudFxyXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJfY2hlY2tPdmVybGFwcGluZ1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hlY2tPdmVybGFwcGluZygpIHtcbiAgICAgIHZhciB4ID0gdGhpcy5pbWFnZVg7XG4gICAgICB2YXIgeSA9IHRoaXMuaW1hZ2VZICsgdGhpcy5pbWFnZUg7XG4gICAgICB2YXIgcmVjdDtcbiAgICAgIHZhciBtYXJnaW4gPSAyMDtcbiAgICAgIGlmICh0aGlzLkhUTUxlbGVtZW50KSBtYXJnaW4gPSA1O1xuICAgICAgZm9yICh2YXIgaW5kZXggaW4gQ09MTElTSU9OX1dJVEgpIHtcbiAgICAgICAgdmFyIGVscyA9IGRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoQ09MTElTSU9OX1dJVEhbaW5kZXhdKTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHJlY3QgPSBlbHNbaV0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgICBpZiAoeSA+IHJlY3QudG9wIC0gMiAmJiB5IDwgcmVjdC50b3AgKyBtYXJnaW4pIHtcbiAgICAgICAgICAgIGlmICh4ID4gcmVjdC5sZWZ0ICYmIHggPCByZWN0LnJpZ2h0IC0gdGhpcy5pbWFnZVcpIHtcbiAgICAgICAgICAgICAgdmFyIHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxzW2ldKTtcbiAgICAgICAgICAgICAgaWYgKHN0eWxlLmJvcmRlclRvcFN0eWxlICE9IFwiXCIgJiYgc3R5bGUuYm9yZGVyVG9wU3R5bGUgIT0gXCJub25lXCIgJiYgc3R5bGUuZGlzcGxheSAhPSBcIm5vbmVcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbHNbaV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKlxyXG4gICAgICogVHJ5IHRvIGdldCB0aGUgdmFsdWUgb2YgYSBub2RlIChmcm9tIHRoZSBjdXJyZW50IGFuaW1hdGlvbk5vZGUpLCBpZiBpdCBpcyBub3QgcG9zc2libGUgcmV0dXJucyB0aGUgZGVmYXVsdFZhbHVlXHJcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcIl9nZXROb2RlVmFsdWVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2dldE5vZGVWYWx1ZShub2RlTmFtZSwgdmFsdWVOYW1lLCBkZWZhdWx0VmFsdWUpIHtcbiAgICAgIGlmICghdGhpcy5hbmltYXRpb25Ob2RlIHx8ICF0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUobm9kZU5hbWUpKSByZXR1cm47XG4gICAgICBpZiAodGhpcy5hbmltYXRpb25Ob2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKG5vZGVOYW1lKVswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSh2YWx1ZU5hbWUpWzBdKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuYW5pbWF0aW9uTm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZShub2RlTmFtZSlbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUodmFsdWVOYW1lKVswXS50ZXh0Q29udGVudDtcblxuICAgICAgICByZXR1cm4gdGhpcy5fcGFyc2VLZXlXb3Jkcyh2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qXHJcbiAgICAgKiBOZXh0IHN0ZXAgKGVhY2ggZnJhbWUgaXMgYSBzdGVwKVxyXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJfbmV4dEVTaGVlcFN0ZXBcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX25leHRFU2hlZXBTdGVwKCkge1xuICAgICAgaWYgKHRoaXMucHJlcGFyZVRvRGllKSByZXR1cm47XG5cbiAgICAgIHZhciB4MSA9IHRoaXMuX2dldE5vZGVWYWx1ZSgnc3RhcnQnLCAneCcsIDApO1xuICAgICAgdmFyIHkxID0gdGhpcy5fZ2V0Tm9kZVZhbHVlKCdzdGFydCcsICd5JywgMCk7XG4gICAgICB2YXIgb2ZmMSA9IHRoaXMuX2dldE5vZGVWYWx1ZSgnc3RhcnQnLCAnb2Zmc2V0eScsIDApO1xuICAgICAgdmFyIG9wYTEgPSB0aGlzLl9nZXROb2RlVmFsdWUoJ3N0YXJ0JywgJ29wYWNpdHknLCAxKTtcbiAgICAgIHZhciBkZWwxID0gdGhpcy5fZ2V0Tm9kZVZhbHVlKCdzdGFydCcsICdpbnRlcnZhbCcsIDEwMDApO1xuICAgICAgdmFyIHgyID0gdGhpcy5fZ2V0Tm9kZVZhbHVlKCdlbmQnLCAneCcsIDApO1xuICAgICAgdmFyIHkyID0gdGhpcy5fZ2V0Tm9kZVZhbHVlKCdlbmQnLCAneScsIDApO1xuICAgICAgdmFyIG9mZjIgPSB0aGlzLl9nZXROb2RlVmFsdWUoJ2VuZCcsICdvZmZzZXR5JywgMCk7XG4gICAgICB2YXIgb3BhMiA9IHRoaXMuX2dldE5vZGVWYWx1ZSgnZW5kJywgJ2ludGVydmFsJywgMSk7XG4gICAgICB2YXIgZGVsMiA9IHRoaXMuX2dldE5vZGVWYWx1ZSgnZW5kJywgJ2ludGVydmFsJywgMTAwMCk7XG5cbiAgICAgIHZhciByZXBlYXQgPSB0aGlzLl9wYXJzZUtleVdvcmRzKHRoaXMuYW5pbWF0aW9uTm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2VxdWVuY2UnKVswXS5nZXRBdHRyaWJ1dGUoJ3JlcGVhdCcpKTtcbiAgICAgIHZhciByZXBlYXRmcm9tID0gdGhpcy5hbmltYXRpb25Ob2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzZXF1ZW5jZScpWzBdLmdldEF0dHJpYnV0ZSgncmVwZWF0ZnJvbScpO1xuICAgICAgdmFyIGdyYXZpdHkgPSB0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2dyYXZpdHknKTtcbiAgICAgIHZhciBib3JkZXIgPSB0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvcmRlcicpO1xuXG4gICAgICB2YXIgc3RlcHMgPSB0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2ZyYW1lJykubGVuZ3RoICsgKHRoaXMuYW5pbWF0aW9uTm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnZnJhbWUnKS5sZW5ndGggLSByZXBlYXRmcm9tKSAqIHJlcGVhdDtcblxuICAgICAgdmFyIGluZGV4O1xuXG4gICAgICBpZiAodGhpcy5hbmltYXRpb25TdGVwIDwgdGhpcy5hbmltYXRpb25Ob2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdmcmFtZScpLmxlbmd0aCkgaW5kZXggPSB0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2ZyYW1lJylbdGhpcy5hbmltYXRpb25TdGVwXS50ZXh0Q29udGVudDtlbHNlIGlmIChyZXBlYXRmcm9tID09IDApIGluZGV4ID0gdGhpcy5hbmltYXRpb25Ob2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdmcmFtZScpW3RoaXMuYW5pbWF0aW9uU3RlcCAlIHRoaXMuYW5pbWF0aW9uTm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnZnJhbWUnKS5sZW5ndGhdLnRleHRDb250ZW50O2Vsc2UgaW5kZXggPSB0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2ZyYW1lJylbcGFyc2VJbnQocmVwZWF0ZnJvbSkgKyBwYXJzZUludCgodGhpcy5hbmltYXRpb25TdGVwIC0gcmVwZWF0ZnJvbSkgJSAodGhpcy5hbmltYXRpb25Ob2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdmcmFtZScpLmxlbmd0aCAtIHJlcGVhdGZyb20pKV0udGV4dENvbnRlbnQ7XG5cbiAgICAgIHRoaXMuRE9NaW1nLnN0eWxlLmxlZnQgPSAtdGhpcy5pbWFnZVcgKiAoaW5kZXggJSB0aGlzLnRpbGVzWCkgKyBcInB4XCI7XG4gICAgICB0aGlzLkRPTWltZy5zdHlsZS50b3AgPSAtdGhpcy5pbWFnZUggKiBwYXJzZUludChpbmRleCAvIHRoaXMudGlsZXNYKSArIFwicHhcIjtcblxuICAgICAgaWYgKHRoaXMuZHJhZ2dpbmcgfHwgdGhpcy5pbmZvYm94KSB7XG4gICAgICAgIHRoaXMuYW5pbWF0aW9uU3RlcCsrO1xuICAgICAgICBzZXRUaW1lb3V0KHRoaXMuX25leHRFU2hlZXBTdGVwLmJpbmQodGhpcyksIDUwKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5mbGlwcGVkKSB7XG4gICAgICAgIHgxID0gLXgxO1xuICAgICAgICB4MiA9IC14MjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uU3RlcCA9PSAwKSB0aGlzLl9zZXRQb3NpdGlvbih4MSwgeTEsIGZhbHNlKTtlbHNlIHRoaXMuX3NldFBvc2l0aW9uKHBhcnNlSW50KHgxKSArIHBhcnNlSW50KCh4MiAtIHgxKSAqIHRoaXMuYW5pbWF0aW9uU3RlcCAvIHN0ZXBzKSwgcGFyc2VJbnQoeTEpICsgcGFyc2VJbnQoKHkyIC0geTEpICogdGhpcy5hbmltYXRpb25TdGVwIC8gc3RlcHMpLCBmYWxzZSk7XG5cbiAgICAgIHRoaXMuYW5pbWF0aW9uU3RlcCsrO1xuXG4gICAgICBpZiAodGhpcy5hbmltYXRpb25TdGVwID49IHN0ZXBzKSB7XG4gICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2FjdGlvbicpWzBdKSB7XG4gICAgICAgICAgc3dpdGNoICh0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2FjdGlvbicpWzBdLnRleHRDb250ZW50KSB7XG4gICAgICAgICAgICBjYXNlIFwiZmxpcFwiOlxuICAgICAgICAgICAgICBpZiAodGhpcy5ET01kaXYuc3R5bGUudHJhbnNmb3JtID09IFwicm90YXRlWSgwZGVnKVwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ET01kaXYuc3R5bGUudHJhbnNmb3JtID0gXCJyb3RhdGVZKDE4MGRlZylcIjtcbiAgICAgICAgICAgICAgICB0aGlzLmZsaXBwZWQgPSB0cnVlO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuRE9NZGl2LnN0eWxlLnRyYW5zZm9ybSA9IFwicm90YXRlWSgwZGVnKVwiO1xuICAgICAgICAgICAgICAgIHRoaXMuZmxpcHBlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcblxuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9nZXROZXh0UmFuZG9tTm9kZSh0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NlcXVlbmNlJylbMF0pKSByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBzZXROZXh0ID0gZmFsc2U7XG5cbiAgICAgIGlmIChib3JkZXIgJiYgYm9yZGVyWzBdICYmIGJvcmRlclswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbmV4dCcpKSB7XG4gICAgICAgIGlmICh4MiA8IDAgJiYgdGhpcy5pbWFnZVggPCAwKSB7XG4gICAgICAgICAgdGhpcy5pbWFnZVggPSAwO1xuICAgICAgICAgIHNldE5leHQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKHgyID4gMCAmJiB0aGlzLmltYWdlWCA+IHRoaXMuc2NyZWVuVyAtIHRoaXMuaW1hZ2VXKSB7XG4gICAgICAgICAgdGhpcy5pbWFnZVggPSB0aGlzLnNjcmVlblcgLSB0aGlzLmltYWdlVztcbiAgICAgICAgICB0aGlzLkRPTWRpdi5zdHlsZS5sZWZ0ID0gcGFyc2VJbnQodGhpcy5pbWFnZVgpICsgXCJweFwiO1xuICAgICAgICAgIHNldE5leHQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKHkyIDwgMCAmJiB0aGlzLmltYWdlWSA8IDApIHtcbiAgICAgICAgICB0aGlzLmltYWdlWSA9IDA7XG4gICAgICAgICAgc2V0TmV4dCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoeTIgPiAwICYmIHRoaXMuaW1hZ2VZID4gdGhpcy5zY3JlZW5IIC0gdGhpcy5pbWFnZUgpIHtcbiAgICAgICAgICB0aGlzLmltYWdlWSA9IHRoaXMuc2NyZWVuSCAtIHRoaXMuaW1hZ2VIO1xuICAgICAgICAgIHNldE5leHQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKHkyID4gMCkge1xuICAgICAgICAgIGlmICh0aGlzLl9jaGVja092ZXJsYXBwaW5nKCkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmltYWdlWSA+IHRoaXMuaW1hZ2VIKSB7XG4gICAgICAgICAgICAgIHRoaXMuSFRNTGVsZW1lbnQgPSB0aGlzLl9jaGVja092ZXJsYXBwaW5nKCk7XG4gICAgICAgICAgICAgIHRoaXMuaW1hZ2VZID0gTWF0aC5jZWlsKHRoaXMuSFRNTGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wKSAtIHRoaXMuaW1hZ2VIO1xuICAgICAgICAgICAgICBzZXROZXh0ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5IVE1MZWxlbWVudCkge1xuICAgICAgICAgIGlmICghdGhpcy5fY2hlY2tPdmVybGFwcGluZygpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pbWFnZVkgKyB0aGlzLmltYWdlSCA+IHRoaXMuSFRNTGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wICsgMyB8fCB0aGlzLmltYWdlWSArIHRoaXMuaW1hZ2VIIDwgdGhpcy5IVE1MZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgLSAzKSB7XG4gICAgICAgICAgICAgIHRoaXMuSFRNTGVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmltYWdlWCA8IHRoaXMuSFRNTGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCkge1xuICAgICAgICAgICAgICB0aGlzLmltYWdlWCA9IHBhcnNlSW50KHRoaXMuaW1hZ2VYICsgMyk7XG4gICAgICAgICAgICAgIHNldE5leHQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5pbWFnZVggPSBwYXJzZUludCh0aGlzLmltYWdlWCAtIDMpO1xuICAgICAgICAgICAgICBzZXROZXh0ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuRE9NZGl2LnN0eWxlLmxlZnQgPSBwYXJzZUludCh0aGlzLmltYWdlWCkgKyBcInB4XCI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzZXROZXh0KSB7XG4gICAgICAgICAgaWYgKCF0aGlzLl9nZXROZXh0UmFuZG9tTm9kZShib3JkZXJbMF0pKSByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghc2V0TmV4dCAmJiBncmF2aXR5ICYmIGdyYXZpdHlbMF0gJiYgZ3Jhdml0eVswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbmV4dCcpKSB7XG4gICAgICAgIGlmICh0aGlzLmltYWdlWSA8IHRoaXMuc2NyZWVuSCAtIHRoaXMuaW1hZ2VIIC0gMikge1xuICAgICAgICAgIGlmICh0aGlzLkhUTUxlbGVtZW50ID09IG51bGwpIHtcbiAgICAgICAgICAgIHNldE5leHQgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2NoZWNrT3ZlcmxhcHBpbmcoKSkge1xuICAgICAgICAgICAgICBzZXROZXh0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgdGhpcy5IVE1MZWxlbWVudCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHNldE5leHQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fZ2V0TmV4dFJhbmRvbU5vZGUoZ3Jhdml0eVswXSkpIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghc2V0TmV4dCkge1xuICAgICAgICBpZiAodGhpcy5pbWFnZVggPCAtdGhpcy5pbWFnZVcgJiYgeDIgPCAwIHx8IHRoaXMuaW1hZ2VYID4gdGhpcy5zY3JlZW5XICYmIHgyID4gMCB8fCB0aGlzLmltYWdlWSA8IC10aGlzLmltYWdlSCAmJiB5MSA8IDAgfHwgdGhpcy5pbWFnZVkgPiB0aGlzLnNjcmVlbkggJiYgeTIgPiAwKSB7XG4gICAgICAgICAgc2V0TmV4dCA9IHRydWU7XG4gICAgICAgICAgaWYgKCF0aGlzLmlzQ2hpbGQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NwYXduRVNoZWVwKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBzZXRUaW1lb3V0KHRoaXMuX25leHRFU2hlZXBTdGVwLmJpbmQodGhpcyksIHBhcnNlSW50KGRlbDEpICsgcGFyc2VJbnQoKGRlbDIgLSBkZWwxKSAqIHRoaXMuYW5pbWF0aW9uU3RlcCAvIHN0ZXBzKSk7XG4gICAgfVxuXG4gICAgLypcclxuICAgICAqIExvYWQgUGV0IExpc3QgZnJvbSBHaXRIdWIsIHNvIHVzZXIgY2FuIGNoYW5nZSBpdFxyXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJfbG9hZFBldExpc3RcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2xvYWRQZXRMaXN0KGVsZW1lbnQpIHtcbiAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICBmZXRjaChcImh0dHBzOi8vYWRyaWFub3RpZ2VyLmdpdGh1Yi5pby93ZWItZXNoZWVwL3BldHMvcGV0cy5qc29uXCIsIHtcbiAgICAgICAgY3JlZGVudGlhbHM6ICdzYW1lLW9yaWdpbicsXG4gICAgICAgIGNhY2hlOiBcImZvcmNlLWNhY2hlXCJcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICB9KS50aGVuKGZ1bmN0aW9uIChqc29uKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGpzb24pO1xuICAgICAgICBpZiAoanNvbi5wZXRzKSB7XG4gICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICBkaXYuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjBweDt0b3A6MjBweDt3aWR0aDoxODNweDtoZWlnaHQ6MTAwJTttaW4taGVpZ2h0OjgwcHg7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCAjODA4MGZmLCAjMzAzMGExKTtjb2xvcjp5ZWxsb3c7XCIpO1xuICAgICAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLmFwcGVuZENoaWxkKGRpdik7XG5cbiAgICAgICAgICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGspIHtcbiAgICAgICAgICAgICAgcGV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJcIik7XG5cbiAgICAgICAgICAgICAgcGV0LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiY3Vyc29yOnBvaW50ZXI7ZGlzcGxheTpibG9jaztcIik7XG4gICAgICAgICAgICAgIHBldC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShqc29uLnBldHNba10ubmFtZSkpO1xuICAgICAgICAgICAgICBwZXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IG5ldyBlU2hlZXAoX3RoaXMzLnVzZXJPcHRpb25zKTtcbiAgICAgICAgICAgICAgICB4LlN0YXJ0KFwiaHR0cHM6Ly9hZHJpYW5vdGlnZXIuZ2l0aHViLmlvL3dlYi1lc2hlZXAvcGV0cy9cIiArIGpzb24ucGV0c1trXS5maWxlKTtcbiAgICAgICAgICAgICAgICBfdGhpczMucmVtb3ZlKCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBkaXYuYXBwZW5kQ2hpbGQocGV0KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZvciAodmFyIGsgaW4ganNvbi5wZXRzKSB7XG4gICAgICAgICAgICAgIHZhciBwZXQ7XG5cbiAgICAgICAgICAgICAgX2xvb3Aoayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRpdik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIGVTaGVlcDtcbn0oKTtcblxuOyJdfQ==
