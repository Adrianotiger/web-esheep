"use strict";var _createClass=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var VERSION="0.7.1",ACTIVATE_DEBUG=!1,DEFAULT_XML="http://esheep.petrucci.ch/script/animation.php",COLLISION_WITH=["div","hr"],eSheep=function(){function eSheep(e){_classCallCheck(this,eSheep),this.animationFile=DEFAULT_XML,this.id=Date.now()+Math.random(),this.DOMdiv=document.createElement("div"),this.DOMdiv.setAttribute("id",this.id),this.DOMimg=document.createElement("img"),this.DOMinfo=document.createElement("div"),this.parser=new DOMParser,this.xmlDoc=null,this.isChild=null!=e,this.tilesX=1,this.tilesY=1,this.imageW=1,this.imageH=1,this.imageX=1,this.imageY=1,this.flipped=!1,this.dragging=!1,this.infobox=!1,this.animationId=0,this.animationStep=0,this.animationNode=null,this.sprite=new Image,this.HTMLelement=null,this.randS=100*Math.random(),this.screenW=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.screenH=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}return _createClass(eSheep,[{key:"Start",value:function(e){void 0!==e&&null!=e&&(this.animationFile=e);var t=new XMLHttpRequest,i=this;t.open("GET",this.animationFile,!0),t.addEventListener("readystatechange",function(){4==this.readyState&&(200==this.status?i._parseXML(this.responseText):console.error("XML not available:"+this.statusText+"\n"+this.responseText))}),t.send(null)}},{key:"remove",value:function(){this.DOMdiv=this.DOMimg=this.DOMinfo=null,document.getElementById(this.id).outerHTML=""}},{key:"_parseXML",value:function(e){var t=this;this.xmlDoc=this.parser.parseFromString(e,"text/xml");var i=this.xmlDoc.getElementsByTagName("image")[0];this.tilesX=i.getElementsByTagName("tilesx")[0].textContent,this.tilesY=i.getElementsByTagName("tilesy")[0].textContent,this.sprite.addEventListener("load",function(){ACTIVATE_DEBUG&&console.log("Sprite image loaded");var e="width:"+t.sprite.width+"px;height:"+t.sprite.height+"px;position:absolute;top:0px;left:0px;max-width: none;";t.DOMimg.setAttribute("style",e),t.DOMimg.addEventListener("dragstart",function(e){return e.preventDefault(),!1}),t.imageW=t.sprite.width/t.tilesX,t.imageH=t.sprite.height/t.tilesY,e="width:"+t.imageW+"px;height:"+t.imageH+"px;position:fixed;top:"+t.imageY+"px;left:"+t.imageX+"px;transform:rotatey(0deg);cursor:move;z-index:2000;overflow:hidden;",t.DOMdiv.setAttribute("style",e),t.DOMdiv.appendChild(t.DOMimg),t.isChild?t._spawnChild():t._spawnESheep()}),this.sprite.src="data:image/png;base64,"+i.getElementsByTagName("png")[0].textContent,this.DOMimg.setAttribute("src",this.sprite.src),this.DOMdiv.addEventListener("mousemove",function(e){if(!this.dragging&&1==e.buttons&&0==e.button){this.dragging=!0,this.HTMLelement=null;for(var t=this.xmlDoc.getElementsByTagName("animations")[0].getElementsByTagName("animation"),i=0;i<t.length;i++)if("drag"==t[i].getElementsByTagName("name")[0].textContent){this.animationId=t[i].getAttribute("id"),this.animationStep=0,this.animationNode=t[i];break}}}.bind(this)),document.body.addEventListener("mousemove",function(e){this.dragging&&(this.imageX=parseInt(e.clientX)-this.imageW/2,this.imageY=parseInt(e.clientY)-this.imageH/2,this.DOMdiv.style.left=this.imageX+"px",this.DOMdiv.style.top=this.imageY+"px")}.bind(this)),document.body.addEventListener("resize",function(e){this.screenW=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.screenH=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,this.imageY+this.imageH>this.screenH&&(this.imageY=this.screenH-this.imageH,this.DOMdiv.style.top=this.imageY+"px"),this.imageX+this.imageW>this.screenW&&(this.imageX=this.screenW-this.imageW,this.DOMdiv.style.left=this.imageX+"px")}.bind(this)),this.DOMdiv.addEventListener("contextmenu",function(e){return e.preventDefault(),!1}),this.DOMdiv.addEventListener("mouseup",function(){t.dragging?t.dragging=!1:t.infobox?(t.DOMinfo.style.display="none",t.infobox=!1):(t.DOMinfo.style.left=Math.min(t.screenW-200,Math.max(0,parseInt(t.imageX+t.imageW/2-parseInt(t.DOMinfo.style.width)/2)))+"px",t.DOMinfo.style.top=parseInt(t.imageY-parseInt(t.DOMinfo.style.height))+"px",t.DOMinfo.style.display="block",t.infobox=!0)}),this.DOMinfo.addEventListener("mouseup",function(e){t.DOMinfo.style.display="none",t.infobox=!1});this.DOMinfo.setAttribute("style","width:200px;height:100px;position:fixed;top:100px;left:10px;display:none;border-width:2px;border-radius:5px;border-style:ridge;border-color:#0000ab;text-align:center;text-shadow: 1px 1px 3px #ffff88;box-shadow: 3px 3px 10px #888888;color:black;opacity:0.9;z-index:9999;overflow:auto;background: linear-gradient(to bottom right, rgba(128,128,255,0.7), rgba(200,200,255,0.4));");var n=document.createElement("b").appendChild(document.createTextNode("eSheep")),a=document.createElement("sup"),s=document.createElement("a");a.appendChild(document.createTextNode("ver: "+VERSION)),a.setAttribute("style","float:right"),s.appendChild(document.createTextNode("http://esheep.petrucci.ch")),s.setAttribute("href","http://esheep.petrucci.ch"),s.setAttribute("target","_blank"),this.DOMinfo.appendChild(n),this.DOMinfo.appendChild(a),this.DOMinfo.appendChild(document.createElement("br")),this.DOMinfo.appendChild(document.createElement("hr")),this.DOMinfo.appendChild(document.createTextNode("Visit the home page of this lovely sheep:")),this.DOMinfo.appendChild(document.createElement("br")),this.DOMinfo.appendChild(s),document.body.appendChild(this.DOMinfo),document.body.appendChild(this.DOMdiv)}},{key:"_setPosition",value:function(e,t,i){i?(this.imageX=parseInt(e),this.imageY=parseInt(t)):(this.imageX=parseInt(this.imageX)+parseInt(e),this.imageY=parseInt(this.imageY)+parseInt(t)),this.DOMdiv&&(this.DOMdiv.style.left=this.imageX+"px",this.DOMdiv.style.top=this.imageY+"px")}},{key:"_spawnESheep",value:function(){for(var e=this.xmlDoc.getElementsByTagName("spawns")[0].getElementsByTagName("spawn"),t=0,i=0;i<e.length;i++)t+=parseInt(e[0].getAttribute("probability"));var n=Math.random()*t;for(i=t=0;i<e.length;i++)if(n<=(t+=parseInt(e[i].getAttribute("probability")))||i==e.length-1){this._setPosition(this._parseKeyWords(e[i].getElementsByTagName("x")[0].textContent),this._parseKeyWords(e[i].getElementsByTagName("y")[0].textContent),!0),ACTIVATE_DEBUG&&console.log("Spawn: "+this.imageX+", "+this.imageY),this.animationId=e[i].getElementsByTagName("next")[0].textContent,this.animationStep=0;for(var a=this.xmlDoc.getElementsByTagName("animations")[0].getElementsByTagName("animation"),s=0;s<a.length;s++)if(a[s].getAttribute("id")==this.animationId){this.animationNode=a[s];a=this.xmlDoc.getElementsByTagName("childs")[0].getElementsByTagName("child");for(var o=0;o<a.length;o++)if(a[o].getAttribute("animationid")==this.animationId){ACTIVATE_DEBUG&&console.log("Child from Spawn");var h=new eSheep(!0);h.animationId=a[o].getElementsByTagName("next")[0].textContent;var m=a[o].getElementsByTagName("x")[0].textContent,r=a[o].getElementsByTagName("y")[0].textContent;h._setPosition(this._parseKeyWords(m),this._parseKeyWords(r),!0),h.Start(this.animationFile);break}break}break}this._nextESheepStep()}},{key:"_spawnChild",value:function(){for(var e=this.xmlDoc.getElementsByTagName("animations")[0].getElementsByTagName("animation"),t=0;t<e.length;t++)if(e[t].getAttribute("id")==this.animationId){this.animationNode=e[t];break}this._nextESheepStep()}},{key:"_parseKeyWords",value:function _parseKeyWords(value){value=value.replace(/screenW/g,this.screenW),value=value.replace(/screenH/g,this.screenH),value=value.replace(/areaW/g,this.screenH),value=value.replace(/areaH/g,this.screenH),value=value.replace(/imageW/g,this.imageW),value=value.replace(/imageH/g,this.imageH),value=value.replace(/random/g,100*Math.random()),value=value.replace(/randS/g,this.randS),value=value.replace(/imageX/g,this.imageX),value=value.replace(/imageY/g,this.imageY);var ret=0;try{ret=eval(value)}catch(e){console.error("Unable to parse this position: \n'"+value+"'\n Error message: \n"+e.message)}return ret}},{key:"_getNextRandomNode",value:function(e){var t=e.getElementsByTagName("next"),i=this.xmlDoc.getElementsByTagName("animations")[0].getElementsByTagName("animation"),n=0,a=!1;if(0==t.length)return this.isChild?(ACTIVATE_DEBUG&&console.log("Remove child"),document.body.removeChild(this.DOMinfo),document.body.removeChild(this.DOMdiv)):this._spawnESheep(),!1;for(var s=0;s<t.length;s++)n+=parseInt(t[s].getAttribute("probability"));var o=Math.random()*n,h=0;for(s=n=0;s<t.length;s++)if(o<=(n+=parseInt(t[s].getAttribute("probability")))){h=s;break}for(s=0;s<i.length;s++)if(i[s].getAttribute("id")==t[h].textContent){this.animationId=i[s].getAttribute("id"),this.animationStep=0,this.animationNode=i[s],a=!0;break}if(a){i=this.xmlDoc.getElementsByTagName("childs")[0].getElementsByTagName("child");for(s=0;s<i.length;s++)if(i[s].getAttribute("animationid")==this.animationId){ACTIVATE_DEBUG&&console.log("Child from Animation");var m=new eSheep(!0);m.animationId=i[s].getElementsByTagName("next")[0].textContent;var r=i[s].getElementsByTagName("x")[0].textContent,l=i[s].getElementsByTagName("y")[0].textContent;m._setPosition(this._parseKeyWords(r),this._parseKeyWords(l),!0),m.Start(this.animationFile);break}}return a}},{key:"_checkOverlapping",value:function(){var e,t=this.imageX,i=this.imageY+this.imageH,n=20;for(var a in this.HTMLelement&&(n=5),COLLISION_WITH)for(var s=document.body.getElementsByTagName(COLLISION_WITH[a]),o=0;o<s.length;o++)if(i>(e=s[o].getBoundingClientRect()).top-2&&i<e.top+n&&t>e.left&&t<e.right-this.imageW){var h=window.getComputedStyle(s[o]);if(""!=h.borderTopStyle&&"none"!=h.borderTopStyle&&"none"!=h.display)return s[o]}return!1}},{key:"_getNodeValue",value:function(e,t,i){if(this.animationNode&&this.animationNode.getElementsByTagName(e)){if(this.animationNode.getElementsByTagName(e)[0].getElementsByTagName(t)[0]){var n=this.animationNode.getElementsByTagName(e)[0].getElementsByTagName(t)[0].textContent;return this._parseKeyWords(n)}return i}}},{key:"_nextESheepStep",value:function(){var e,t=this._getNodeValue("start","x",0),i=this._getNodeValue("start","y",0),n=(this._getNodeValue("start","offsety",0),this._getNodeValue("start","opacity",1),this._getNodeValue("start","interval",1e3)),a=this._getNodeValue("end","x",0),s=this._getNodeValue("end","y",0),o=(this._getNodeValue("end","offsety",0),this._getNodeValue("end","interval",1),this._getNodeValue("end","interval",1e3)),h=this._parseKeyWords(this.animationNode.getElementsByTagName("sequence")[0].getAttribute("repeat")),m=this.animationNode.getElementsByTagName("sequence")[0].getAttribute("repeatfrom"),r=this.animationNode.getElementsByTagName("gravity"),l=this.animationNode.getElementsByTagName("border"),g=this.animationNode.getElementsByTagName("frame").length+(this.animationNode.getElementsByTagName("frame").length-m)*h;if(e=this.animationStep<this.animationNode.getElementsByTagName("frame").length?this.animationNode.getElementsByTagName("frame")[this.animationStep].textContent:0==m?this.animationNode.getElementsByTagName("frame")[this.animationStep%this.animationNode.getElementsByTagName("frame").length].textContent:this.animationNode.getElementsByTagName("frame")[parseInt(m)+parseInt((this.animationStep-m)%(this.animationNode.getElementsByTagName("frame").length-m))].textContent,this.DOMimg.style.left=-this.imageW*(e%this.tilesX)+"px",this.DOMimg.style.top=-this.imageH*parseInt(e/this.tilesX)+"px",this.dragging||this.infobox)return this.animationStep++,void setTimeout(this._nextESheepStep.bind(this),50);if(this.flipped&&(t=-t,a=-a),0==this.animationStep?this._setPosition(t,i,!1):this._setPosition(parseInt(t)+parseInt((a-t)*this.animationStep/g),parseInt(i)+parseInt((s-i)*this.animationStep/g),!1),this.animationStep++,this.animationStep>=g){if(this.animationNode.getElementsByTagName("action")[0])switch(this.animationNode.getElementsByTagName("action")[0].textContent){case"flip":"rotateY(0deg)"==this.DOMdiv.style.transform?(this.DOMdiv.style.transform="rotateY(180deg)",this.flipped=!0):(this.DOMdiv.style.transform="rotateY(0deg)",this.flipped=!1)}if(!this._getNextRandomNode(this.animationNode.getElementsByTagName("sequence")[0]))return}var d=!1;return l&&l[0]&&l[0].getElementsByTagName("next")&&(a<0&&this.imageX<0?d=!(this.imageX=0):0<a&&this.imageX>this.screenW-this.imageW?(this.imageX=this.screenW-this.imageW,this.DOMdiv.style.left=parseInt(this.imageX)+"px",d=!0):s<0&&this.imageY<0?d=!(this.imageY=0):0<s&&this.imageY>this.screenH-this.imageH?(this.imageY=this.screenH-this.imageH,d=!0):0<s?this._checkOverlapping()&&this.imageY>this.imageH&&(this.HTMLelement=this._checkOverlapping(),this.imageY=Math.ceil(this.HTMLelement.getBoundingClientRect().top)-this.imageH,d=!0):this.HTMLelement&&(this._checkOverlapping()||(this.imageY+this.imageH>this.HTMLelement.getBoundingClientRect().top+3||this.imageY+this.imageH<this.HTMLelement.getBoundingClientRect().top-3?this.HTMLelement=null:(this.imageX<this.HTMLelement.getBoundingClientRect().left?this.imageX=parseInt(this.imageX+3):this.imageX=parseInt(this.imageX-3),d=!0),this.DOMdiv.style.left=parseInt(this.imageX)+"px")),d&&!this._getNextRandomNode(l[0]))||!d&&r&&r[0]&&r[0].getElementsByTagName("next")&&this.imageY<this.screenH-this.imageH-2&&(null==this.HTMLelement?d=!0:this._checkOverlapping()||(d=!0,this.HTMLelement=null),d&&!this._getNextRandomNode(r[0]))?void 0:!d&&(this.imageX<-this.imageW&&a<0||this.imageX>this.screenW&&0<a||this.imageY<-this.imageH&&i<0||this.imageY>this.screenH&&0<s)?(d=!0,void(this.isChild||this._spawnESheep())):void setTimeout(this._nextESheepStep.bind(this),parseInt(n)+parseInt((o-n)*this.animationStep/g))}}]),eSheep}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVzaGVlcC5taW4uanMiXSwibmFtZXMiOlsiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsIkNvbnN0cnVjdG9yIiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwicHJvdG90eXBlIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJUeXBlRXJyb3IiLCJWRVJTSU9OIiwiQUNUSVZBVEVfREVCVUciLCJERUZBVUxUX1hNTCIsIkNPTExJU0lPTl9XSVRIIiwiZVNoZWVwIiwiaXNDaGlsZCIsInRoaXMiLCJhbmltYXRpb25GaWxlIiwiaWQiLCJEYXRlIiwibm93IiwiTWF0aCIsInJhbmRvbSIsIkRPTWRpdiIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsIkRPTWltZyIsIkRPTWluZm8iLCJwYXJzZXIiLCJET01QYXJzZXIiLCJ4bWxEb2MiLCJ0aWxlc1giLCJ0aWxlc1kiLCJpbWFnZVciLCJpbWFnZUgiLCJpbWFnZVgiLCJpbWFnZVkiLCJmbGlwcGVkIiwiZHJhZ2dpbmciLCJpbmZvYm94IiwiYW5pbWF0aW9uSWQiLCJhbmltYXRpb25TdGVwIiwiYW5pbWF0aW9uTm9kZSIsInNwcml0ZSIsIkltYWdlIiwiSFRNTGVsZW1lbnQiLCJyYW5kUyIsInNjcmVlblciLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiZG9jdW1lbnRFbGVtZW50IiwiY2xpZW50V2lkdGgiLCJib2R5Iiwic2NyZWVuSCIsImlubmVySGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwidmFsdWUiLCJhbmltYXRpb24iLCJhamF4IiwiWE1MSHR0cFJlcXVlc3QiLCJzaGVlcENsYXNzIiwib3BlbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwiX3BhcnNlWE1MIiwicmVzcG9uc2VUZXh0IiwiY29uc29sZSIsImVycm9yIiwic3RhdHVzVGV4dCIsInNlbmQiLCJnZXRFbGVtZW50QnlJZCIsIm91dGVySFRNTCIsInRleHQiLCJfdGhpcyIsInBhcnNlRnJvbVN0cmluZyIsImltYWdlIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJ0ZXh0Q29udGVudCIsImxvZyIsImF0dHJpYnV0ZSIsIndpZHRoIiwiaGVpZ2h0IiwiZSIsInByZXZlbnREZWZhdWx0IiwiYXBwZW5kQ2hpbGQiLCJfc3Bhd25DaGlsZCIsIl9zcGF3bkVTaGVlcCIsInNyYyIsImJ1dHRvbnMiLCJidXR0b24iLCJjaGlsZHMiLCJrIiwiZ2V0QXR0cmlidXRlIiwiYmluZCIsInBhcnNlSW50IiwiY2xpZW50WCIsImNsaWVudFkiLCJzdHlsZSIsImxlZnQiLCJ0b3AiLCJkaXNwbGF5IiwibWluIiwibWF4IiwiaHRtbFQiLCJjcmVhdGVUZXh0Tm9kZSIsImh0bWxWIiwiaHRtbEwiLCJ4IiwieSIsImFic29sdXRlIiwic3Bhd25zIiwicHJvYiIsInJhbmQiLCJfc2V0UG9zaXRpb24iLCJfcGFyc2VLZXlXb3JkcyIsImoiLCJlU2hlZXBDaGlsZCIsIlN0YXJ0IiwiX25leHRFU2hlZXBTdGVwIiwicmVwbGFjZSIsInJldCIsImV2YWwiLCJlcnIiLCJtZXNzYWdlIiwicGFyZW50Tm9kZSIsImJhc2VOb2RlIiwibm9kZUZvdW5kIiwicmVtb3ZlQ2hpbGQiLCJpbmRleCIsInJlY3QiLCJtYXJnaW4iLCJlbHMiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJyaWdodCIsImdldENvbXB1dGVkU3R5bGUiLCJib3JkZXJUb3BTdHlsZSIsIm5vZGVOYW1lIiwidmFsdWVOYW1lIiwiZGVmYXVsdFZhbHVlIiwieDEiLCJfZ2V0Tm9kZVZhbHVlIiwieTEiLCJkZWwxIiwieDIiLCJ5MiIsImRlbDIiLCJyZXBlYXQiLCJyZXBlYXRmcm9tIiwiZ3Jhdml0eSIsImJvcmRlciIsInN0ZXBzIiwic2V0VGltZW91dCIsInRyYW5zZm9ybSIsIl9nZXROZXh0UmFuZG9tTm9kZSIsInNldE5leHQiLCJfY2hlY2tPdmVybGFwcGluZyIsImNlaWwiXSwibWFwcGluZ3MiOiJBQUFBLGFBRUEsSUFBSUEsYUFBZSxXQUFjLFNBQVNDLEVBQWlCQyxFQUFRQyxHQUFTLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsSUFBSUUsRUFBYUgsRUFBTUMsR0FBSUUsRUFBV0MsV0FBYUQsRUFBV0MsYUFBYyxFQUFPRCxFQUFXRSxjQUFlLEVBQVUsVUFBV0YsSUFBWUEsRUFBV0csVUFBVyxHQUFNQyxPQUFPQyxlQUFlVCxFQUFRSSxFQUFXTSxJQUFLTixJQUFpQixPQUFPLFNBQVVPLEVBQWFDLEVBQVlDLEdBQWlKLE9BQTlIRCxHQUFZYixFQUFpQlksRUFBWUcsVUFBV0YsR0FBaUJDLEdBQWFkLEVBQWlCWSxFQUFhRSxHQUFxQkYsR0FBN2dCLEdBRW5CLFNBQVNJLGdCQUFnQkMsRUFBVUwsR0FBZSxLQUFNSyxhQUFvQkwsR0FBZ0IsTUFBTSxJQUFJTSxVQUFVLHFDQXNEaEgsSUFBSUMsUUFBVSxRQUNWQyxnQkFBaUIsRUFDakJDLFlBQWMsaURBQ2RDLGVBQWlCLENBQUMsTUFBTyxNQVF6QkMsT0FBUyxXQUNYLFNBQVNBLE9BQU9DLEdBQ2RSLGdCQUFnQlMsS0FBTUYsUUFJdEJFLEtBQUtDLGNBQWdCTCxZQUVyQkksS0FBS0UsR0FBS0MsS0FBS0MsTUFBUUMsS0FBS0MsU0FFNUJOLEtBQUtPLE9BQVNDLFNBQVNDLGNBQWMsT0FDckNULEtBQUtPLE9BQU9HLGFBQWEsS0FBTVYsS0FBS0UsSUFDcENGLEtBQUtXLE9BQVNILFNBQVNDLGNBQWMsT0FDckNULEtBQUtZLFFBQVVKLFNBQVNDLGNBQWMsT0FFdENULEtBQUthLE9BQVMsSUFBSUMsVUFDbEJkLEtBQUtlLE9BQVMsS0FFZGYsS0FBS0QsUUFBcUIsTUFBWEEsRUFFZkMsS0FBS2dCLE9BQVMsRUFDZGhCLEtBQUtpQixPQUFTLEVB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QUFMNEYsSUFDeEpVLEdBQVUsT0FDTDVJLEtBQUtELFNBQ1JDLEtBQUt3RSxzQkFNWGlFLFdBQVd6SSxLQUFLd0csZ0JBQWdCekIsS0FBSy9FLE1BQU9nRixTQUFTZ0QsR0FBUWhELFVBQVVtRCxFQUFPSCxHQUFRaEksS0FBSzBCLGNBQWdCOEcsUUFJeEcxSSxPQXBrQkkiLCJmaWxlIjoiZXNoZWVwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKlxyXG4gKiBQcm9qZWN0OlxyXG4gKiAgICAgICAgICAgICAgICBlU2hlZXAgLSBXZWJwYWdlXHJcbiAqXHJcbiAqIERhdGU6XHJcbiAqICAgICAgICAgICAgICAgIDA0LmFwcmlsIDIwMThcclxuICpcclxuICogQXV0aG9yOlxyXG4gKiAgICAgICAgICAgICAgICBBZHJpYW5vIFBldHJ1Y2NpIChodHRwOi8vZXNoZWVwLnBldHJ1Y2NpLmNoKVxyXG4gKlxyXG4gKiBWZXJzaW9uOiAgICAgICAwLjcuMVxyXG4gKlxyXG4gKiBJbnRyb2R1Y3Rpb246XHJcbiAqICAgICAgICAgICAgICAgIEFzIFwid3JhcHBlclwiIGZvciB0aGUgT3BlblNvdXJjZSBDIyBwcm9qZWN0XHJcbiAqICAgICAgICAgICAgICAgIChzZWUgaHR0cHM6Ly9naXRodWIuY29tL0Fkcmlhbm90aWdlci9kZXNrdG9wUGV0KSxcclxuICogICAgICAgICAgICAgICAgdGhpcyBqYXZhc2NyaXB0IFwiY2xhc3NcIiB3YXMgd3JpdHRlbiB0byBnZXQgdGhlIGFuaW1hdGlvbnMgYWxzbyBpbnNpZGUgeW91clxyXG4gKiAgICAgICAgICAgICAgICB3ZWJwYWdlLiBJdCBkb2Vzbid0IHdvcmsgbGlrZSB0aGUgV2luZG93cyB2ZXJzaW9uLCBidXQgc2hvdyBtdWNoIGFuaW1hdGlvbnMgZnJvbSBpdC5cclxuICpcclxuICogRGVzY3JpcHRpb246XHJcbiAqICAgICAgICAgICAgICAgIEFkZCBhIHdhbGtpbmcgcGV0IChzaGVlcCB0byB5b3VyIGhvbWUgcGFnZSkgd2l0aCBqdXN0IGEgZmV3IGxpbmVzIG9mIGNvZGUhXHJcbiAqICAgICAgICAgICAgICAgIFdpbGwgYWRkIGEgbG92ZWx5IHNoZWVwIChzdHJheSBzaGVlcCkgYW5kIHRoaXMgd2lsbCB3YWxrIGFyb3VuZCB5b3VyIHBhZ2UgYW5kIG92ZXJcclxuICogICAgICAgICAgICAgICAgYWxsIDxocj5zIGFuZCA8ZGl2PnMgd2l0aCBhIGJvcmRlci4gWW91IGNhbiBhbHNvIHNlbGVjdCBhbm90aGVyIGFuaW1hdGlvbiwgdXNpbmcgeW91clxyXG4gKiAgICAgICAgICAgICAgICBwZXJzb25hbCBYTUwgZmlsZSBvciBvbmUgZnJvbSB0aGUgZGF0YWJhc2UuXHJcbiAqXHJcbiAqIEhvdyB0byB1c2U6XHJcbiAqICAgICAgICAgICAgICAgIEFkZCB0aGlzIGxpbmUgaW4geW91ciA8aGVhZGVyPjpcclxuICogICAgICAgICAgICAgICAgPHNjcmlwdCBzcmM9XCJodHRwOi8vZXNoZWVwLnBldHJ1Y2NpLmNoL3NjcmlwdC9EZXNrdG9wUGV0LmpzXCI+PC9zY3JpcHQ+XHJcbiAqICAgICAgICAgICAgICAgIEFkZCB0aGlzIGxpbmVzIGluIHlvdXIgPGJvZHk+IChhdCB0aGUgZW5kIGlmIHBvc3NpYmxlKTpcclxuICogICAgICAgICAgICAgICAgPHNjcmlwdD5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGV0ID0gbmV3IEVTaGVlcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBldC5TdGFydCgnaHR0cDovL2VzaGVlcC5wZXRydWNjaS5jaC9zY3JpcHQvYW5pbWF0aW9uLnhtbCcpO1xyXG4gICAgICAgICAgICAgICAgICA8L3NjcmlwdD5cclxuICogICAgICAgICAgICAgICAgVGhhdCdzIGFsbCFcclxuICpcclxuICogUmVxdWlyZW1lbnQ6XHJcbiAqICAgICAgICAgICAgICAgIFRlc3RlZCBvbiBJRTExLCBFZGdlIGFuZCBPcGVyYVxyXG4gKlxyXG4gKiBDaGFuZ2Vsb2c6XHJcbiAqICAgICAgICAgICAgICAgIFZlcnNpb24gMC43LjEgLSAwNC4wNC4yMDE4OlxyXG4gKiAgICAgICAgICAgICAgICAgIC0gQWRkIG1heC13aWR0aDogbm9uZSB0byBlbnN1cmUgdGhlIGltYWdlIGlzIHByb3Blcmx5IHNob3duXHJcbiAqICAgICAgICAgICAgICAgIFZlcnNpb24gMC43IC0gMTMuMTEuMjAxNzpcclxuICogICAgICAgICAgICAgICAgICAtIGJldHRlciBKYXZhc2NyaXB0IHN0cnVjdHVyZVxyXG4gKiAgICAgICAgICAgICAgICAgIC0gR2l0SHViIHZlcnNpb24gKGh0dHBzOi8vZ2l0aHViLmNvbS9BZHJpYW5vdGlnZXIvd2ViLWVzaGVlcClcclxuICogICAgICAgICAgICAgICAgICAtIENoaWxkcyBhbmltYXRpb25zIGFkZGVkXHJcbiAqICAgICAgICAgICAgICAgICAgLSBCZXR0ZXIgY29tbWVudHNcclxuICogICAgICAgICAgICAgICAgICAtIFJlcGxhY2VkIGFsZXJ0cyB3aXRoIGNvbnNvbGUuZXJyb3JcclxuICogICAgICAgICAgICAgICAgVmVyc2lvbiAwLjUgLSAxMi4wNy4yMDE3OlxyXG4gKiAgICAgICAgICAgICAgICAgIC0gYW5pbWF0aW9ucyBzdGFydHMgb25seSBvbmNlIHRoZSBpbWFnZSB3YXMgbG9hZGVkICh0aGFua3MgUmVkU3BhcnIwdylcclxuICogICAgICAgICAgICAgICAgVmVyc2lvbiAwLng6XHJcbiAqICAgICAgICAgICAgICAgICAgLSBzdGlsbCBiZXRhIHZlcnNpb25zLi4uXHJcbiAqL1xuXG52YXIgVkVSU0lPTiA9ICcwLjcuMSc7IC8vIHdlYiBlU2hlZXAgdmVyc2lvblxudmFyIEFDVElWQVRFX0RFQlVHID0gZmFsc2U7IC8vIHNob3cgbG9nIG9uIGNvbnNvbGVcbnZhciBERUZBVUxUX1hNTCA9IFwiaHR0cDovL2VzaGVlcC5wZXRydWNjaS5jaC9zY3JpcHQvYW5pbWF0aW9uLnBocFwiOyAvLyBkZWZhdWx0IFhNTCBhbmltYXRpb25cbnZhciBDT0xMSVNJT05fV0lUSCA9IFtcImRpdlwiLCBcImhyXCJdOyAvLyBlbGVtZW50cyBvbiBwYWdlIHRvIGRldGVjdCBmb3IgY29sbGlzaW9uc1xuXG4vKlxyXG4gKiBlU2hlZXAgY2xhc3MuXHJcbiAqIENyZWF0ZSBhIG5ldyBjbGFzcyBvZiB0aGlzIHR5cGUgaWYgeW91IHdhbnQgYSBuZXcgcGV0LiBXaWxsIGNyZWF0ZSB0aGUgY29tcG9uZW50cyBmb3IgdGhlIHBldC5cclxuICogT25jZSBjcmVhdGVkLCB5b3UgY2FuIGNhbGwgW3ZhcmlhYmxlTmFtZV0uU3RhcnQoKSB0byBzdGFydCB0aGUgYW5pbWF0aW9uIHdpdGggeW91ciBkZXNpcmVkIHBldC5cclxuICovXG5cbnZhciBlU2hlZXAgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIGVTaGVlcChpc0NoaWxkKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIGVTaGVlcCk7XG5cbiAgICAvLyBDT1JTOiBDcm9zcyBjYWxscyBhcmUgbm90IGFjY2VwdGVkIGJ5IG5ldyBicm93c2Vycy5cbiAgICAvLyBUaGlzIFBIUC1zY3JpcHQgYWxsb3dzIHRvIGNhbGwgdGhlIHBhZ2UgYWxzbyBmcm9tIG90aGVyIGRvbWFpbnNcbiAgICB0aGlzLmFuaW1hdGlvbkZpbGUgPSBERUZBVUxUX1hNTDtcblxuICAgIHRoaXMuaWQgPSBEYXRlLm5vdygpICsgTWF0aC5yYW5kb20oKTtcblxuICAgIHRoaXMuRE9NZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTsgLy8gRGl2IGFkZGVkIHRvIHdlYnBhZ2UsIGNvbnRhaW5pbmcgdGhlIHNoZWVwXG4gICAgdGhpcy5ET01kaXYuc2V0QXR0cmlidXRlKFwiaWRcIiwgdGhpcy5pZCk7XG4gICAgdGhpcy5ET01pbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpOyAvLyBUaWxlIGltYWdlLCB3aWxsIGJlIHBvc2l0aW9uZWQgaW5zaWRlIHRoZSBkaXZcbiAgICB0aGlzLkRPTWluZm8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpOyAvLyBhYm91dCBkaWFsb2csIGlmIHlvdSBwcmVzcyBvbiB0aGUgc2hlZXBcblxuICAgIHRoaXMucGFyc2VyID0gbmV3IERPTVBhcnNlcigpOyAvLyBYTUwgcGFyc2VyXG4gICAgdGhpcy54bWxEb2MgPSBudWxsOyAvLyBwYXJzZWQgWE1MIERvY3VtZW50XG5cbiAgICB0aGlzLmlzQ2hpbGQgPSBpc0NoaWxkICE9IG51bGw7IC8vIENoaWxkIHdpbGwgYmUgcmVtb3ZlZCBvbmNlIHRoZXkgcmVhY2hlZCB0aGUgZW5kXG5cbiAgICB0aGlzLnRpbGVzWCA9IDE7IC8vIFF1YW50aXR5IG9mIGltYWdlcyBpbnNpZGUgVGlsZVxuICAgIHRoaXMudGlsZXNZID0gMTsgLy8gUXVhbnRpdHkgb2YgaW1hZ2VzIGluc2lkZSBUaWxlXG4gICAgdGhpcy5pbWFnZVcgPSAxOyAvLyBXaWR0aCBvZiB0aGUgc3ByaXRlIGltYWdlXG4gICAgdGhpcy5pbWFnZUggPSAxOyAvLyBIZWlnaHQgb2YgdGhlIHNwcml0ZSBpbWFnZVxuICAgIHRoaXMuaW1hZ2VYID0gMTsgLy8gUG9zaXRpb24gb2Ygc3ByaXRlIGluc2lkZSB3ZWJwYWdlXG4gICAgdGhpcy5pbWFnZVkgPSAxOyAvLyBQb3NpdGlvbiBvZiBzcHJpdGUgaW5zaWRlIHdlYnBhZ2VcbiAgICB0aGlzLmZsaXBwZWQgPSBmYWxzZTsgLy8gaWYgc3ByaXRlIGlzIGZsaXBwZWRcbiAgICB0aGlzLmRyYWdnaW5nID0gZmFsc2U7IC8vIGlmIHVzZXIgaXMgZHJhZ2dpbmcgdGhlIHNoZWVwXG4gICAgdGhpcy5pbmZvYm94ID0gZmFsc2U7IC8vIGlmIGluZm9ib3ggaXMgdmlzaWJsZVxuICAgIHRoaXMuYW5pbWF0aW9uSWQgPSAwOyAvLyBjdXJyZW50IGFuaW1hdGlvbiBJRFxuICAgIHRoaXMuYW5pbWF0aW9uU3RlcCA9IDA7IC8vIGN1cnJlbnQgYW5pbWF0aW9uIHN0ZXBcbiAgICB0aGlzLmFuaW1hdGlvbk5vZGUgPSBudWxsOyAvLyBjdXJyZW50IGFuaW1hdGlvbiBET00gbm9kZVxuICAgIHRoaXMuc3ByaXRlID0gbmV3IEltYWdlKCk7IC8vIHNwcml0ZSBpbWFnZSAoVGlsZXMpXG4gICAgdGhpcy5IVE1MZWxlbWVudCA9IG51bGw7IC8vIHRoZSBIVE1MIGVsZW1lbnQgd2hlcmUgdGhlIHBldCBpcyB3YWxraW5nIG9uXG4gICAgdGhpcy5yYW5kUyA9IE1hdGgucmFuZG9tKCkgKiAxMDA7IC8vIHJhbmRvbSB2YWx1ZSwgd2lsbCBjaGFuZ2Ugd2hlbiBwYWdlIGlzIHJlbG9hZGVkXG5cbiAgICB0aGlzLnNjcmVlblcgPSB3aW5kb3cuaW5uZXJXaWR0aCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggfHwgZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aDsgLy8gd2luZG93IHdpZHRoXG5cbiAgICB0aGlzLnNjcmVlbkggPSB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCB8fCBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodDsgLy8gd2luZG93IGhlaWdodFxuICB9XG5cbiAgLypcclxuICAgKiBTdGFydCBuZXcgYW5pbWF0aW9uIG9uIHRoZSBwYWdlLlxyXG4gICAqIGlmIGFuaW1hdGlvbiBpcyBub3Qgc2V0LCB0aGUgZGVmYXVsdCBzaGVlcCB3aWxsIGJlIHRha2VuXHJcbiAgICovXG5cblxuICBfY3JlYXRlQ2xhc3MoZVNoZWVwLCBbe1xuICAgIGtleTogXCJTdGFydFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBTdGFydChhbmltYXRpb24pIHtcbiAgICAgIGlmICh0eXBlb2YgYW5pbWF0aW9uICE9PSAndW5kZWZpbmVkJyAmJiBhbmltYXRpb24gIT0gbnVsbCkge1xuICAgICAgICB0aGlzLmFuaW1hdGlvbkZpbGUgPSBhbmltYXRpb247XG4gICAgICB9XG5cbiAgICAgIHZhciBhamF4ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICB2YXIgc2hlZXBDbGFzcyA9IHRoaXM7XG5cbiAgICAgIGFqYXgub3BlbihcIkdFVFwiLCB0aGlzLmFuaW1hdGlvbkZpbGUsIHRydWUpO1xuICAgICAgYWpheC5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlzdGF0ZWNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT0gNCkge1xuICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PSAyMDApXG4gICAgICAgICAgICAvLyBzdWNjZXNzZnVsbHkgbG9hZGVkIFhNTCwgcGFyc2UgaXQgYW5kIGNyZWF0ZSBmaXJzdCBlc2hlZXAuXG4gICAgICAgICAgICBzaGVlcENsYXNzLl9wYXJzZVhNTCh0aGlzLnJlc3BvbnNlVGV4dCk7ZWxzZSBjb25zb2xlLmVycm9yKFwiWE1MIG5vdCBhdmFpbGFibGU6XCIgKyB0aGlzLnN0YXR1c1RleHQgKyBcIlxcblwiICsgdGhpcy5yZXNwb25zZVRleHQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGFqYXguc2VuZChudWxsKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVtb3ZlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICAgIHRoaXMuRE9NZGl2ID0gdGhpcy5ET01pbWcgPSB0aGlzLkRPTWluZm8gPSBudWxsO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5pZCkub3V0ZXJIVE1MID0gJyc7XG4gICAgfVxuXG4gICAgLypcclxuICAgICAqIFBhcnNlIGxvYWRlZCBYTUwsIGNvbnRhaW5zIHNwYXduLCBhbmltYXRpb25zIGFuZCBjaGlsZHNcclxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiX3BhcnNlWE1MXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9wYXJzZVhNTCh0ZXh0KSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICB0aGlzLnhtbERvYyA9IHRoaXMucGFyc2VyLnBhcnNlRnJvbVN0cmluZyh0ZXh0LCAndGV4dC94bWwnKTtcbiAgICAgIHZhciBpbWFnZSA9IHRoaXMueG1sRG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbWFnZScpWzBdO1xuICAgICAgdGhpcy50aWxlc1ggPSBpbWFnZS5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRpbGVzeFwiKVswXS50ZXh0Q29udGVudDtcbiAgICAgIHRoaXMudGlsZXNZID0gaW1hZ2UuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0aWxlc3lcIilbMF0udGV4dENvbnRlbnQ7XG4gICAgICAvLyBFdmVudCBsaXN0ZW5lcjogU3ByaXRlIHdhcyBsb2FkZWQgPT5cbiAgICAgIC8vICAgcGxheSBhbmltYXRpb24gb25seSB3aGVuIHRoZSBzcHJpdGUgaXMgbG9hZGVkXG4gICAgICB0aGlzLnNwcml0ZS5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChBQ1RJVkFURV9ERUJVRykgY29uc29sZS5sb2coXCJTcHJpdGUgaW1hZ2UgbG9hZGVkXCIpO1xuICAgICAgICB2YXIgYXR0cmlidXRlID0gXCJ3aWR0aDpcIiArIF90aGlzLnNwcml0ZS53aWR0aCArIFwicHg7XCIgKyBcImhlaWdodDpcIiArIF90aGlzLnNwcml0ZS5oZWlnaHQgKyBcInB4O1wiICsgXCJwb3NpdGlvbjphYnNvbHV0ZTtcIiArIFwidG9wOjBweDtcIiArIFwibGVmdDowcHg7XCIgKyBcIm1heC13aWR0aDogbm9uZTtcIjtcbiAgICAgICAgX3RoaXMuRE9NaW1nLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIGF0dHJpYnV0ZSk7XG4gICAgICAgIC8vIHByZXZlbnQgdG8gbW92ZSBpbWFnZSAod2lsbCBzaG93IHRoZSBlbnRpcmUgc3ByaXRlIHNoZWV0IGlmIG5vdCBjYXRjaGVkKVxuICAgICAgICBfdGhpcy5ET01pbWcuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdzdGFydFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtyZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICBfdGhpcy5pbWFnZVcgPSBfdGhpcy5zcHJpdGUud2lkdGggLyBfdGhpcy50aWxlc1g7XG4gICAgICAgIF90aGlzLmltYWdlSCA9IF90aGlzLnNwcml0ZS5oZWlnaHQgLyBfdGhpcy50aWxlc1k7XG4gICAgICAgIC8vaWYodHlwZW9mIHRoaXMuaW1hZ2VYID09ICd1bmRlZmluZWQnKSB0aGlzLmltYWdlWCA9IDA7XG4gICAgICAgIC8vaWYodHlwZW9mIHRoaXMuaW1hZ2VZID09ICd1bmRlZmluZWQnKSB0aGlzLmltYWdlWSA9IHRoaXMuc2NyZWVuSCAtIHRoaXMuc3ByaXRlLmhlaWdodCAvIHRoaXMudGlsZXNZO1xuICAgICAgICBhdHRyaWJ1dGUgPSBcIndpZHRoOlwiICsgX3RoaXMuaW1hZ2VXICsgXCJweDtcIiArIFwiaGVpZ2h0OlwiICsgX3RoaXMuaW1hZ2VIICsgXCJweDtcIiArIFwicG9zaXRpb246Zml4ZWQ7XCIgKyBcInRvcDpcIiArIF90aGlzLmltYWdlWSArIFwicHg7XCIgKyBcImxlZnQ6XCIgKyBfdGhpcy5pbWFnZVggKyBcInB4O1wiICsgXCJ0cmFuc2Zvcm06cm90YXRleSgwZGVnKTtcIiArIFwiY3Vyc29yOm1vdmU7XCIgKyBcInotaW5kZXg6MjAwMDtcIiArIFwib3ZlcmZsb3c6aGlkZGVuO1wiO1xuICAgICAgICBfdGhpcy5ET01kaXYuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgYXR0cmlidXRlKTtcbiAgICAgICAgX3RoaXMuRE9NZGl2LmFwcGVuZENoaWxkKF90aGlzLkRPTWltZyk7XG5cbiAgICAgICAgaWYgKF90aGlzLmlzQ2hpbGQpIF90aGlzLl9zcGF3bkNoaWxkKCk7ZWxzZSBfdGhpcy5fc3Bhd25FU2hlZXAoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLnNwcml0ZS5zcmMgPSAnZGF0YTppbWFnZS9wbmc7YmFzZTY0LCcgKyBpbWFnZS5nZXRFbGVtZW50c0J5VGFnTmFtZShcInBuZ1wiKVswXS50ZXh0Q29udGVudDtcbiAgICAgIHRoaXMuRE9NaW1nLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLnNwcml0ZS5zcmMpO1xuXG4gICAgICAvLyBNb3VzZSBtb3ZlIG92ZXIgZVNoZWVwLCBjaGVjayBpZiBlU2hlZXAgc2hvdWxkIGJlIG1vdmVkIG92ZXIgdGhlIHNjcmVlblxuICAgICAgdGhpcy5ET01kaXYuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoIXRoaXMuZHJhZ2dpbmcgJiYgZS5idXR0b25zID09IDEgJiYgZS5idXR0b24gPT0gMCkge1xuICAgICAgICAgIHRoaXMuZHJhZ2dpbmcgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuSFRNTGVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgIHZhciBjaGlsZHNSb290ID0gdGhpcy54bWxEb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2FuaW1hdGlvbnMnKVswXTtcbiAgICAgICAgICB2YXIgY2hpbGRzID0gY2hpbGRzUm9vdC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYW5pbWF0aW9uJyk7XG4gICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBjaGlsZHMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgIGlmIChjaGlsZHNba10uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ25hbWUnKVswXS50ZXh0Q29udGVudCA9PSBcImRyYWdcIikge1xuICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbklkID0gY2hpbGRzW2tdLmdldEF0dHJpYnV0ZShcImlkXCIpO1xuICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvblN0ZXAgPSAwO1xuICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbk5vZGUgPSBjaGlsZHNba107XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lciB0byBib2R5LCBpZiBtb3VzZSBtb3ZlZCB0b28gZmFzdCBvdmVyIHRoZSBkcmFnZ2luZyBlU2hlZXBcbiAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodGhpcy5kcmFnZ2luZykge1xuICAgICAgICAgIHRoaXMuaW1hZ2VYID0gcGFyc2VJbnQoZS5jbGllbnRYKSAtIHRoaXMuaW1hZ2VXIC8gMjtcbiAgICAgICAgICB0aGlzLmltYWdlWSA9IHBhcnNlSW50KGUuY2xpZW50WSkgLSB0aGlzLmltYWdlSCAvIDI7XG5cbiAgICAgICAgICB0aGlzLkRPTWRpdi5zdHlsZS5sZWZ0ID0gdGhpcy5pbWFnZVggKyBcInB4XCI7XG4gICAgICAgICAgdGhpcy5ET01kaXYuc3R5bGUudG9wID0gdGhpcy5pbWFnZVkgKyBcInB4XCI7XG4gICAgICAgIH1cbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgICAvLyBXaW5kb3cgcmVzaXplZCwgcmVjYWxjdWxhdGUgZVNoZWVwIGJvdW5kc1xuICAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMuc2NyZWVuVyA9IHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCB8fCBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoO1xuXG4gICAgICAgIHRoaXMuc2NyZWVuSCA9IHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0O1xuXG4gICAgICAgIGlmICh0aGlzLmltYWdlWSArIHRoaXMuaW1hZ2VIID4gdGhpcy5zY3JlZW5IKSB7XG4gICAgICAgICAgdGhpcy5pbWFnZVkgPSB0aGlzLnNjcmVlbkggLSB0aGlzLmltYWdlSDtcbiAgICAgICAgICB0aGlzLkRPTWRpdi5zdHlsZS50b3AgPSB0aGlzLmltYWdlWSArIFwicHhcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pbWFnZVggKyB0aGlzLmltYWdlVyA+IHRoaXMuc2NyZWVuVykge1xuICAgICAgICAgIHRoaXMuaW1hZ2VYID0gdGhpcy5zY3JlZW5XIC0gdGhpcy5pbWFnZVc7XG4gICAgICAgICAgdGhpcy5ET01kaXYuc3R5bGUubGVmdCA9IHRoaXMuaW1hZ2VYICsgXCJweFwiO1xuICAgICAgICB9XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgLy8gRG9uJ3QgYWxsb3cgY29udGV4dG1lbnUgb3ZlciB0aGUgc2hlZXBcbiAgICAgIHRoaXMuRE9NZGl2LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0pO1xuICAgICAgLy8gTW91c2UgcmVsZWFzZWRcbiAgICAgIHRoaXMuRE9NZGl2LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKF90aGlzLmRyYWdnaW5nKSB7XG4gICAgICAgICAgX3RoaXMuZHJhZ2dpbmcgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIGlmIChfdGhpcy5pbmZvYm94KSB7XG4gICAgICAgICAgX3RoaXMuRE9NaW5mby5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgICAgX3RoaXMuaW5mb2JveCA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF90aGlzLkRPTWluZm8uc3R5bGUubGVmdCA9IE1hdGgubWluKF90aGlzLnNjcmVlblcgLSAyMDAsIE1hdGgubWF4KDAsIHBhcnNlSW50KF90aGlzLmltYWdlWCArIF90aGlzLmltYWdlVyAvIDIgLSBwYXJzZUludChfdGhpcy5ET01pbmZvLnN0eWxlLndpZHRoKSAvIDIpKSkgKyBcInB4XCI7XG4gICAgICAgICAgX3RoaXMuRE9NaW5mby5zdHlsZS50b3AgPSBwYXJzZUludChfdGhpcy5pbWFnZVkgLSBwYXJzZUludChfdGhpcy5ET01pbmZvLnN0eWxlLmhlaWdodCkpICsgXCJweFwiO1xuICAgICAgICAgIF90aGlzLkRPTWluZm8uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgICBfdGhpcy5pbmZvYm94ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICAvLyBNb3VzZSByZWxlYXNlZCBvdmVyIHRoZSBpbmZvIGJveFxuICAgICAgdGhpcy5ET01pbmZvLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIF90aGlzLkRPTWluZm8uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICBfdGhpcy5pbmZvYm94ID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICAgIC8vIENyZWF0ZSBBYm91dCBib3hcbiAgICAgIHZhciBhdHRyaWJ1dGUgPSBcIndpZHRoOjIwMHB4O1wiICsgXCJoZWlnaHQ6MTAwcHg7XCIgKyBcInBvc2l0aW9uOmZpeGVkO1wiICsgXCJ0b3A6MTAwcHg7bGVmdDoxMHB4O1wiICsgXCJkaXNwbGF5Om5vbmU7XCIgKyBcImJvcmRlci13aWR0aDoycHg7XCIgKyBcImJvcmRlci1yYWRpdXM6NXB4O1wiICsgXCJib3JkZXItc3R5bGU6cmlkZ2U7XCIgKyBcImJvcmRlci1jb2xvcjojMDAwMGFiO1wiICsgXCJ0ZXh0LWFsaWduOmNlbnRlcjtcIiArIFwidGV4dC1zaGFkb3c6IDFweCAxcHggM3B4ICNmZmZmODg7XCIgKyBcImJveC1zaGFkb3c6IDNweCAzcHggMTBweCAjODg4ODg4O1wiICsgXCJjb2xvcjpibGFjaztcIiArIFwib3BhY2l0eTowLjk7XCIgKyBcInotaW5kZXg6OTk5OTtcIiArIFwib3ZlcmZsb3c6YXV0bztcIiArIFwiYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSByaWdodCwgcmdiYSgxMjgsMTI4LDI1NSwwLjcpLCByZ2JhKDIwMCwyMDAsMjU1LDAuNCkpO1wiO1xuICAgICAgdGhpcy5ET01pbmZvLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIGF0dHJpYnV0ZSk7XG4gICAgICB2YXIgaHRtbFQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYlwiKS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcImVTaGVlcFwiKSk7XG4gICAgICB2YXIgaHRtbFYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3VwXCIpO1xuICAgICAgdmFyIGh0bWxMID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XG4gICAgICBodG1sVi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcInZlcjogXCIgKyBWRVJTSU9OKSk7XG4gICAgICBodG1sVi5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImZsb2F0OnJpZ2h0XCIpO1xuICAgICAgaHRtbEwuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJodHRwOi8vZXNoZWVwLnBldHJ1Y2NpLmNoXCIpKTtcbiAgICAgIGh0bWxMLnNldEF0dHJpYnV0ZShcImhyZWZcIiwgXCJodHRwOi8vZXNoZWVwLnBldHJ1Y2NpLmNoXCIpO1xuICAgICAgaHRtbEwuc2V0QXR0cmlidXRlKFwidGFyZ2V0XCIsIFwiX2JsYW5rXCIpO1xuICAgICAgdGhpcy5ET01pbmZvLmFwcGVuZENoaWxkKGh0bWxUKTtcbiAgICAgIHRoaXMuRE9NaW5mby5hcHBlbmRDaGlsZChodG1sVik7XG4gICAgICB0aGlzLkRPTWluZm8uYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJyXCIpKTtcbiAgICAgIHRoaXMuRE9NaW5mby5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaHJcIikpO1xuICAgICAgdGhpcy5ET01pbmZvLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiVmlzaXQgdGhlIGhvbWUgcGFnZSBvZiB0aGlzIGxvdmVseSBzaGVlcDpcIikpO1xuICAgICAgdGhpcy5ET01pbmZvLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKSk7XG4gICAgICB0aGlzLkRPTWluZm8uYXBwZW5kQ2hpbGQoaHRtbEwpO1xuICAgICAgLy8gQWRkIGFib3V0IGFuZCBzaGVlcCBlbGVtZW50cyB0byB0aGUgYm9keVxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLkRPTWluZm8pO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLkRPTWRpdik7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIl9zZXRQb3NpdGlvblwiLFxuXG5cbiAgICAvKlxyXG4gICAgICogU2V0IG5ldyBwb3NpdGlvbiBmb3IgdGhlIHBldFxyXG4gICAgICogSWYgYWJzb2x1dGUgaXMgdHJ1ZSwgdGhlIHggYW5kIHkgY29vcmRpbmF0ZXMgYXJlIHVzZWQgYXMgYWJzb2x1dGUgdmFsdWVzLlxyXG4gICAgICogSWYgZmFsc2UsIHggYW5kIHkgYXJlIGFkZGVkIHRvIHRoZSBjdXJyZW50IHBvc2l0aW9uXHJcbiAgICAgKi9cbiAgICB2YWx1ZTogZnVuY3Rpb24gX3NldFBvc2l0aW9uKHgsIHksIGFic29sdXRlKSB7XG4gICAgICBpZiAoYWJzb2x1dGUpIHtcbiAgICAgICAgdGhpcy5pbWFnZVggPSBwYXJzZUludCh4KTtcbiAgICAgICAgdGhpcy5pbWFnZVkgPSBwYXJzZUludCh5KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaW1hZ2VYID0gcGFyc2VJbnQodGhpcy5pbWFnZVgpICsgcGFyc2VJbnQoeCk7XG4gICAgICAgIHRoaXMuaW1hZ2VZID0gcGFyc2VJbnQodGhpcy5pbWFnZVkpICsgcGFyc2VJbnQoeSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLkRPTWRpdikge1xuICAgICAgICB0aGlzLkRPTWRpdi5zdHlsZS5sZWZ0ID0gdGhpcy5pbWFnZVggKyBcInB4XCI7XG4gICAgICAgIHRoaXMuRE9NZGl2LnN0eWxlLnRvcCA9IHRoaXMuaW1hZ2VZICsgXCJweFwiO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qXHJcbiAgICAgKiBTcGF3biBuZXcgZXNoZWVwLCB0aGlzIGlzIGNhbGxlZCBpZiB0aGUgWE1MIHdhcyBsb2FkZWQgc3VjY2Vzc2Z1bGx5XHJcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcIl9zcGF3bkVTaGVlcFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfc3Bhd25FU2hlZXAoKSB7XG4gICAgICB2YXIgc3Bhd25zUm9vdCA9IHRoaXMueG1sRG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzcGF3bnMnKVswXTtcbiAgICAgIHZhciBzcGF3bnMgPSBzcGF3bnNSb290LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzcGF3bicpO1xuICAgICAgdmFyIHByb2IgPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzcGF3bnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgcHJvYiArPSBwYXJzZUludChzcGF3bnNbMF0uZ2V0QXR0cmlidXRlKFwicHJvYmFiaWxpdHlcIikpO1xuICAgICAgfXZhciByYW5kID0gTWF0aC5yYW5kb20oKSAqIHByb2I7XG4gICAgICBwcm9iID0gMDtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBzcGF3bnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgcHJvYiArPSBwYXJzZUludChzcGF3bnNbaV0uZ2V0QXR0cmlidXRlKFwicHJvYmFiaWxpdHlcIikpO1xuICAgICAgICBpZiAocHJvYiA+PSByYW5kIHx8IGkgPT0gc3Bhd25zLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICB0aGlzLl9zZXRQb3NpdGlvbih0aGlzLl9wYXJzZUtleVdvcmRzKHNwYXduc1tpXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgneCcpWzBdLnRleHRDb250ZW50KSwgdGhpcy5fcGFyc2VLZXlXb3JkcyhzcGF3bnNbaV0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3knKVswXS50ZXh0Q29udGVudCksIHRydWUpO1xuICAgICAgICAgIGlmIChBQ1RJVkFURV9ERUJVRykgY29uc29sZS5sb2coXCJTcGF3bjogXCIgKyB0aGlzLmltYWdlWCArIFwiLCBcIiArIHRoaXMuaW1hZ2VZKTtcbiAgICAgICAgICB0aGlzLmFuaW1hdGlvbklkID0gc3Bhd25zW2ldLmdldEVsZW1lbnRzQnlUYWdOYW1lKCduZXh0JylbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgICAgdGhpcy5hbmltYXRpb25TdGVwID0gMDtcbiAgICAgICAgICB2YXIgY2hpbGRzUm9vdCA9IHRoaXMueG1sRG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdhbmltYXRpb25zJylbMF07XG4gICAgICAgICAgdmFyIGNoaWxkcyA9IGNoaWxkc1Jvb3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2FuaW1hdGlvbicpO1xuICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY2hpbGRzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICBpZiAoY2hpbGRzW2tdLmdldEF0dHJpYnV0ZShcImlkXCIpID09IHRoaXMuYW5pbWF0aW9uSWQpIHtcbiAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb25Ob2RlID0gY2hpbGRzW2tdO1xuXG4gICAgICAgICAgICAgIC8vIENoZWNrIGlmIGNoaWxkIHNob3VsZCBiZSBsb2FkZWQgdG9naGV0aGVyIHdpdGggdGhpcyBhbmltYXRpb25cbiAgICAgICAgICAgICAgdmFyIGNoaWxkc1Jvb3QgPSB0aGlzLnhtbERvYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnY2hpbGRzJylbMF07XG4gICAgICAgICAgICAgIHZhciBjaGlsZHMgPSBjaGlsZHNSb290LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdjaGlsZCcpO1xuICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNoaWxkcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZHNbal0uZ2V0QXR0cmlidXRlKFwiYW5pbWF0aW9uaWRcIikgPT0gdGhpcy5hbmltYXRpb25JZCkge1xuICAgICAgICAgICAgICAgICAgaWYgKEFDVElWQVRFX0RFQlVHKSBjb25zb2xlLmxvZyhcIkNoaWxkIGZyb20gU3Bhd25cIik7XG4gICAgICAgICAgICAgICAgICB2YXIgZVNoZWVwQ2hpbGQgPSBuZXcgZVNoZWVwKHRydWUpO1xuICAgICAgICAgICAgICAgICAgZVNoZWVwQ2hpbGQuYW5pbWF0aW9uSWQgPSBjaGlsZHNbal0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ25leHQnKVswXS50ZXh0Q29udGVudDtcbiAgICAgICAgICAgICAgICAgIHZhciB4ID0gY2hpbGRzW2pdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd4JylbMF0udGV4dENvbnRlbnQ7IC8vXG4gICAgICAgICAgICAgICAgICB2YXIgeSA9IGNoaWxkc1tqXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgneScpWzBdLnRleHRDb250ZW50O1xuICAgICAgICAgICAgICAgICAgZVNoZWVwQ2hpbGQuX3NldFBvc2l0aW9uKHRoaXMuX3BhcnNlS2V5V29yZHMoeCksIHRoaXMuX3BhcnNlS2V5V29yZHMoeSksIHRydWUpO1xuICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgYW5pbWF0aW9uXG4gICAgICAgICAgICAgICAgICBlU2hlZXBDaGlsZC5TdGFydCh0aGlzLmFuaW1hdGlvbkZpbGUpO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gUGxheSBuZXh0IHN0ZXBcbiAgICAgIHRoaXMuX25leHRFU2hlZXBTdGVwKCk7XG4gICAgfVxuXG4gICAgLypcclxuICAgICAqIExpa2Ugc3Bhd25FU2hlZXAsIGJ1dCBmb3IgQ2hpbGRzXHJcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcIl9zcGF3bkNoaWxkXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9zcGF3bkNoaWxkKCkge1xuICAgICAgdmFyIGNoaWxkc1Jvb3QgPSB0aGlzLnhtbERvYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYW5pbWF0aW9ucycpWzBdO1xuICAgICAgdmFyIGNoaWxkcyA9IGNoaWxkc1Jvb3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2FuaW1hdGlvbicpO1xuICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBjaGlsZHMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgaWYgKGNoaWxkc1trXS5nZXRBdHRyaWJ1dGUoXCJpZFwiKSA9PSB0aGlzLmFuaW1hdGlvbklkKSB7XG4gICAgICAgICAgdGhpcy5hbmltYXRpb25Ob2RlID0gY2hpbGRzW2tdO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLl9uZXh0RVNoZWVwU3RlcCgpO1xuICAgIH1cblxuICAgIC8vIFBhcnNlIHRoZSBodW1hbiByZWFkYWJsZSBleHByZXNzaW9uIGZyb20gWE1MIHRvIGEgY29tcHV0ZXIgcmVhZGFibGUgZXhwcmVzc2lvblxuXG4gIH0sIHtcbiAgICBrZXk6IFwiX3BhcnNlS2V5V29yZHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX3BhcnNlS2V5V29yZHModmFsdWUpIHtcbiAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvc2NyZWVuVy9nLCB0aGlzLnNjcmVlblcpO1xuICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9zY3JlZW5IL2csIHRoaXMuc2NyZWVuSCk7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL2FyZWFXL2csIHRoaXMuc2NyZWVuSCk7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL2FyZWFIL2csIHRoaXMuc2NyZWVuSCk7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL2ltYWdlVy9nLCB0aGlzLmltYWdlVyk7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL2ltYWdlSC9nLCB0aGlzLmltYWdlSCk7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL3JhbmRvbS9nLCBNYXRoLnJhbmRvbSgpICogMTAwKTtcbiAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvcmFuZFMvZywgdGhpcy5yYW5kUyk7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL2ltYWdlWC9nLCB0aGlzLmltYWdlWCk7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL2ltYWdlWS9nLCB0aGlzLmltYWdlWSk7XG5cbiAgICAgIHZhciByZXQgPSAwO1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0ID0gZXZhbCh2YWx1ZSk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlVuYWJsZSB0byBwYXJzZSB0aGlzIHBvc2l0aW9uOiBcXG4nXCIgKyB2YWx1ZSArIFwiJ1xcbiBFcnJvciBtZXNzYWdlOiBcXG5cIiArIGVyci5tZXNzYWdlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuXG4gICAgLypcclxuICAgICAqIE9uY2UgdGhlIGFuaW1hdGlvbiBpcyBvdmVyLCBnZXQgdGhlIG5leHQgYW5pbWF0aW9uIHRvIHBsYXlcclxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiX2dldE5leHRSYW5kb21Ob2RlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXROZXh0UmFuZG9tTm9kZShwYXJlbnROb2RlKSB7XG4gICAgICB2YXIgYmFzZU5vZGUgPSBwYXJlbnROb2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCduZXh0Jyk7XG4gICAgICB2YXIgY2hpbGRzUm9vdCA9IHRoaXMueG1sRG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdhbmltYXRpb25zJylbMF07XG4gICAgICB2YXIgY2hpbGRzID0gY2hpbGRzUm9vdC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYW5pbWF0aW9uJyk7XG4gICAgICB2YXIgcHJvYiA9IDA7XG4gICAgICB2YXIgbm9kZUZvdW5kID0gZmFsc2U7XG5cbiAgICAgIC8vIG5vIG1vcmUgYW5pbWF0aW9ucyAoaXQgd2FzIHRoZSBsYXN0IG9uZSlcbiAgICAgIGlmIChiYXNlTm9kZS5sZW5ndGggPT0gMCkge1xuICAgICAgICAvLyBJZiBpdCBpcyBhIGNoaWxkLCByZW1vdmUgdGhlIGNoaWxkIGZyb20gZG9jdW1lbnRcbiAgICAgICAgaWYgKHRoaXMuaXNDaGlsZCkge1xuICAgICAgICAgIC8vIHJlbW92ZSBjaGlsZFxuICAgICAgICAgIGlmIChBQ1RJVkFURV9ERUJVRykgY29uc29sZS5sb2coXCJSZW1vdmUgY2hpbGRcIik7XG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLkRPTWluZm8pO1xuICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5ET01kaXYpO1xuICAgICAgICAgIGRlbGV0ZSB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIC8vIGVsc2UsIHNwYXduIHNoZWVwIGFnYWluXG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fc3Bhd25FU2hlZXAoKTtcbiAgICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBiYXNlTm9kZS5sZW5ndGg7IGsrKykge1xuICAgICAgICBwcm9iICs9IHBhcnNlSW50KGJhc2VOb2RlW2tdLmdldEF0dHJpYnV0ZShcInByb2JhYmlsaXR5XCIpKTtcbiAgICAgIH1cbiAgICAgIHZhciByYW5kID0gTWF0aC5yYW5kb20oKSAqIHByb2I7XG4gICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgcHJvYiA9IDA7XG4gICAgICBmb3IgKGsgPSAwOyBrIDwgYmFzZU5vZGUubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgcHJvYiArPSBwYXJzZUludChiYXNlTm9kZVtrXS5nZXRBdHRyaWJ1dGUoXCJwcm9iYWJpbGl0eVwiKSk7XG4gICAgICAgIGlmIChwcm9iID49IHJhbmQpIHtcbiAgICAgICAgICBpbmRleCA9IGs7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZvciAoayA9IDA7IGsgPCBjaGlsZHMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgaWYgKGNoaWxkc1trXS5nZXRBdHRyaWJ1dGUoXCJpZFwiKSA9PSBiYXNlTm9kZVtpbmRleF0udGV4dENvbnRlbnQpIHtcbiAgICAgICAgICB0aGlzLmFuaW1hdGlvbklkID0gY2hpbGRzW2tdLmdldEF0dHJpYnV0ZShcImlkXCIpO1xuICAgICAgICAgIHRoaXMuYW5pbWF0aW9uU3RlcCA9IDA7XG4gICAgICAgICAgdGhpcy5hbmltYXRpb25Ob2RlID0gY2hpbGRzW2tdO1xuICAgICAgICAgIG5vZGVGb3VuZCA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKG5vZGVGb3VuZCkgLy8gY3JlYXRlIENoaWxkLCBpZiBwcmVzZW50XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgY2hpbGRzUm9vdCA9IHRoaXMueG1sRG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdjaGlsZHMnKVswXTtcbiAgICAgICAgICB2YXIgY2hpbGRzID0gY2hpbGRzUm9vdC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnY2hpbGQnKTtcbiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgY2hpbGRzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICBpZiAoY2hpbGRzW2tdLmdldEF0dHJpYnV0ZShcImFuaW1hdGlvbmlkXCIpID09IHRoaXMuYW5pbWF0aW9uSWQpIHtcbiAgICAgICAgICAgICAgaWYgKEFDVElWQVRFX0RFQlVHKSBjb25zb2xlLmxvZyhcIkNoaWxkIGZyb20gQW5pbWF0aW9uXCIpO1xuICAgICAgICAgICAgICB2YXIgZVNoZWVwQ2hpbGQgPSBuZXcgZVNoZWVwKHRydWUpO1xuICAgICAgICAgICAgICBlU2hlZXBDaGlsZC5hbmltYXRpb25JZCA9IGNoaWxkc1trXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbmV4dCcpWzBdLnRleHRDb250ZW50O1xuICAgICAgICAgICAgICB2YXIgeCA9IGNoaWxkc1trXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgneCcpWzBdLnRleHRDb250ZW50OyAvL1xuICAgICAgICAgICAgICB2YXIgeSA9IGNoaWxkc1trXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgneScpWzBdLnRleHRDb250ZW50O1xuICAgICAgICAgICAgICBlU2hlZXBDaGlsZC5fc2V0UG9zaXRpb24odGhpcy5fcGFyc2VLZXlXb3Jkcyh4KSwgdGhpcy5fcGFyc2VLZXlXb3Jkcyh5KSwgdHJ1ZSk7XG4gICAgICAgICAgICAgIGVTaGVlcENoaWxkLlN0YXJ0KHRoaXMuYW5pbWF0aW9uRmlsZSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICByZXR1cm4gbm9kZUZvdW5kO1xuICAgIH1cblxuICAgIC8qXHJcbiAgICAgKiBDaGVjayBpZiBzaGVlcCBpcyB3YWxraW5nIG92ZXIgYSBkZWZpbmVkIEhUTUwgVEFHLWVsZW1lbnRcclxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiX2NoZWNrT3ZlcmxhcHBpbmdcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2NoZWNrT3ZlcmxhcHBpbmcoKSB7XG4gICAgICB2YXIgeCA9IHRoaXMuaW1hZ2VYO1xuICAgICAgdmFyIHkgPSB0aGlzLmltYWdlWSArIHRoaXMuaW1hZ2VIO1xuICAgICAgdmFyIHJlY3Q7XG4gICAgICB2YXIgbWFyZ2luID0gMjA7XG4gICAgICBpZiAodGhpcy5IVE1MZWxlbWVudCkgbWFyZ2luID0gNTtcbiAgICAgIGZvciAodmFyIGluZGV4IGluIENPTExJU0lPTl9XSVRIKSB7XG4gICAgICAgIHZhciBlbHMgPSBkb2N1bWVudC5ib2R5LmdldEVsZW1lbnRzQnlUYWdOYW1lKENPTExJU0lPTl9XSVRIW2luZGV4XSk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICByZWN0ID0gZWxzW2ldLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgICAgaWYgKHkgPiByZWN0LnRvcCAtIDIgJiYgeSA8IHJlY3QudG9wICsgbWFyZ2luKSB7XG4gICAgICAgICAgICBpZiAoeCA+IHJlY3QubGVmdCAmJiB4IDwgcmVjdC5yaWdodCAtIHRoaXMuaW1hZ2VXKSB7XG4gICAgICAgICAgICAgIHZhciBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsc1tpXSk7XG4gICAgICAgICAgICAgIGlmIChzdHlsZS5ib3JkZXJUb3BTdHlsZSAhPSBcIlwiICYmIHN0eWxlLmJvcmRlclRvcFN0eWxlICE9IFwibm9uZVwiICYmIHN0eWxlLmRpc3BsYXkgIT0gXCJub25lXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxzW2ldO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLypcclxuICAgICAqIFRyeSB0byBnZXQgdGhlIHZhbHVlIG9mIGEgbm9kZSAoZnJvbSB0aGUgY3VycmVudCBhbmltYXRpb25Ob2RlKSwgaWYgaXQgaXMgbm90IHBvc3NpYmxlIHJldHVybnMgdGhlIGRlZmF1bHRWYWx1ZVxyXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJfZ2V0Tm9kZVZhbHVlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXROb2RlVmFsdWUobm9kZU5hbWUsIHZhbHVlTmFtZSwgZGVmYXVsdFZhbHVlKSB7XG4gICAgICBpZiAoIXRoaXMuYW5pbWF0aW9uTm9kZSB8fCAhdGhpcy5hbmltYXRpb25Ob2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKG5vZGVOYW1lKSkgcmV0dXJuO1xuICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uTm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZShub2RlTmFtZSlbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUodmFsdWVOYW1lKVswXSkge1xuICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUobm9kZU5hbWUpWzBdLmdldEVsZW1lbnRzQnlUYWdOYW1lKHZhbHVlTmFtZSlbMF0udGV4dENvbnRlbnQ7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhcnNlS2V5V29yZHModmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKlxyXG4gICAgICogTmV4dCBzdGVwIChlYWNoIGZyYW1lIGlzIGEgc3RlcClcclxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiX25leHRFU2hlZXBTdGVwXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9uZXh0RVNoZWVwU3RlcCgpIHtcbiAgICAgIHZhciB4MSA9IHRoaXMuX2dldE5vZGVWYWx1ZSgnc3RhcnQnLCAneCcsIDApO1xuICAgICAgdmFyIHkxID0gdGhpcy5fZ2V0Tm9kZVZhbHVlKCdzdGFydCcsICd5JywgMCk7XG4gICAgICB2YXIgb2ZmMSA9IHRoaXMuX2dldE5vZGVWYWx1ZSgnc3RhcnQnLCAnb2Zmc2V0eScsIDApO1xuICAgICAgdmFyIG9wYTEgPSB0aGlzLl9nZXROb2RlVmFsdWUoJ3N0YXJ0JywgJ29wYWNpdHknLCAxKTtcbiAgICAgIHZhciBkZWwxID0gdGhpcy5fZ2V0Tm9kZVZhbHVlKCdzdGFydCcsICdpbnRlcnZhbCcsIDEwMDApO1xuICAgICAgdmFyIHgyID0gdGhpcy5fZ2V0Tm9kZVZhbHVlKCdlbmQnLCAneCcsIDApO1xuICAgICAgdmFyIHkyID0gdGhpcy5fZ2V0Tm9kZVZhbHVlKCdlbmQnLCAneScsIDApO1xuICAgICAgdmFyIG9mZjIgPSB0aGlzLl9nZXROb2RlVmFsdWUoJ2VuZCcsICdvZmZzZXR5JywgMCk7XG4gICAgICB2YXIgb3BhMiA9IHRoaXMuX2dldE5vZGVWYWx1ZSgnZW5kJywgJ2ludGVydmFsJywgMSk7XG4gICAgICB2YXIgZGVsMiA9IHRoaXMuX2dldE5vZGVWYWx1ZSgnZW5kJywgJ2ludGVydmFsJywgMTAwMCk7XG5cbiAgICAgIHZhciByZXBlYXQgPSB0aGlzLl9wYXJzZUtleVdvcmRzKHRoaXMuYW5pbWF0aW9uTm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2VxdWVuY2UnKVswXS5nZXRBdHRyaWJ1dGUoJ3JlcGVhdCcpKTtcbiAgICAgIHZhciByZXBlYXRmcm9tID0gdGhpcy5hbmltYXRpb25Ob2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzZXF1ZW5jZScpWzBdLmdldEF0dHJpYnV0ZSgncmVwZWF0ZnJvbScpO1xuICAgICAgdmFyIGdyYXZpdHkgPSB0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2dyYXZpdHknKTtcbiAgICAgIHZhciBib3JkZXIgPSB0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvcmRlcicpO1xuXG4gICAgICB2YXIgc3RlcHMgPSB0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2ZyYW1lJykubGVuZ3RoICsgKHRoaXMuYW5pbWF0aW9uTm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnZnJhbWUnKS5sZW5ndGggLSByZXBlYXRmcm9tKSAqIHJlcGVhdDtcblxuICAgICAgdmFyIGluZGV4O1xuXG4gICAgICBpZiAodGhpcy5hbmltYXRpb25TdGVwIDwgdGhpcy5hbmltYXRpb25Ob2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdmcmFtZScpLmxlbmd0aCkgaW5kZXggPSB0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2ZyYW1lJylbdGhpcy5hbmltYXRpb25TdGVwXS50ZXh0Q29udGVudDtlbHNlIGlmIChyZXBlYXRmcm9tID09IDApIGluZGV4ID0gdGhpcy5hbmltYXRpb25Ob2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdmcmFtZScpW3RoaXMuYW5pbWF0aW9uU3RlcCAlIHRoaXMuYW5pbWF0aW9uTm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnZnJhbWUnKS5sZW5ndGhdLnRleHRDb250ZW50O2Vsc2UgaW5kZXggPSB0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2ZyYW1lJylbcGFyc2VJbnQocmVwZWF0ZnJvbSkgKyBwYXJzZUludCgodGhpcy5hbmltYXRpb25TdGVwIC0gcmVwZWF0ZnJvbSkgJSAodGhpcy5hbmltYXRpb25Ob2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdmcmFtZScpLmxlbmd0aCAtIHJlcGVhdGZyb20pKV0udGV4dENvbnRlbnQ7XG5cbiAgICAgIHRoaXMuRE9NaW1nLnN0eWxlLmxlZnQgPSAtdGhpcy5pbWFnZVcgKiAoaW5kZXggJSB0aGlzLnRpbGVzWCkgKyBcInB4XCI7XG4gICAgICB0aGlzLkRPTWltZy5zdHlsZS50b3AgPSAtdGhpcy5pbWFnZUggKiBwYXJzZUludChpbmRleCAvIHRoaXMudGlsZXNYKSArIFwicHhcIjtcblxuICAgICAgaWYgKHRoaXMuZHJhZ2dpbmcgfHwgdGhpcy5pbmZvYm94KSB7XG4gICAgICAgIHRoaXMuYW5pbWF0aW9uU3RlcCsrO1xuICAgICAgICBzZXRUaW1lb3V0KHRoaXMuX25leHRFU2hlZXBTdGVwLmJpbmQodGhpcyksIDUwKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5mbGlwcGVkKSB7XG4gICAgICAgIHgxID0gLXgxO1xuICAgICAgICB4MiA9IC14MjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uU3RlcCA9PSAwKSB0aGlzLl9zZXRQb3NpdGlvbih4MSwgeTEsIGZhbHNlKTtlbHNlIHRoaXMuX3NldFBvc2l0aW9uKHBhcnNlSW50KHgxKSArIHBhcnNlSW50KCh4MiAtIHgxKSAqIHRoaXMuYW5pbWF0aW9uU3RlcCAvIHN0ZXBzKSwgcGFyc2VJbnQoeTEpICsgcGFyc2VJbnQoKHkyIC0geTEpICogdGhpcy5hbmltYXRpb25TdGVwIC8gc3RlcHMpLCBmYWxzZSk7XG5cbiAgICAgIHRoaXMuYW5pbWF0aW9uU3RlcCsrO1xuXG4gICAgICBpZiAodGhpcy5hbmltYXRpb25TdGVwID49IHN0ZXBzKSB7XG4gICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2FjdGlvbicpWzBdKSB7XG4gICAgICAgICAgc3dpdGNoICh0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2FjdGlvbicpWzBdLnRleHRDb250ZW50KSB7XG4gICAgICAgICAgICBjYXNlIFwiZmxpcFwiOlxuICAgICAgICAgICAgICBpZiAodGhpcy5ET01kaXYuc3R5bGUudHJhbnNmb3JtID09IFwicm90YXRlWSgwZGVnKVwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ET01kaXYuc3R5bGUudHJhbnNmb3JtID0gXCJyb3RhdGVZKDE4MGRlZylcIjtcbiAgICAgICAgICAgICAgICB0aGlzLmZsaXBwZWQgPSB0cnVlO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuRE9NZGl2LnN0eWxlLnRyYW5zZm9ybSA9IFwicm90YXRlWSgwZGVnKVwiO1xuICAgICAgICAgICAgICAgIHRoaXMuZmxpcHBlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcblxuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9nZXROZXh0UmFuZG9tTm9kZSh0aGlzLmFuaW1hdGlvbk5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NlcXVlbmNlJylbMF0pKSByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBzZXROZXh0ID0gZmFsc2U7XG5cbiAgICAgIGlmIChib3JkZXIgJiYgYm9yZGVyWzBdICYmIGJvcmRlclswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbmV4dCcpKSB7XG4gICAgICAgIGlmICh4MiA8IDAgJiYgdGhpcy5pbWFnZVggPCAwKSB7XG4gICAgICAgICAgdGhpcy5pbWFnZVggPSAwO1xuICAgICAgICAgIHNldE5leHQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKHgyID4gMCAmJiB0aGlzLmltYWdlWCA+IHRoaXMuc2NyZWVuVyAtIHRoaXMuaW1hZ2VXKSB7XG4gICAgICAgICAgdGhpcy5pbWFnZVggPSB0aGlzLnNjcmVlblcgLSB0aGlzLmltYWdlVztcbiAgICAgICAgICB0aGlzLkRPTWRpdi5zdHlsZS5sZWZ0ID0gcGFyc2VJbnQodGhpcy5pbWFnZVgpICsgXCJweFwiO1xuICAgICAgICAgIHNldE5leHQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKHkyIDwgMCAmJiB0aGlzLmltYWdlWSA8IDApIHtcbiAgICAgICAgICB0aGlzLmltYWdlWSA9IDA7XG4gICAgICAgICAgc2V0TmV4dCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoeTIgPiAwICYmIHRoaXMuaW1hZ2VZID4gdGhpcy5zY3JlZW5IIC0gdGhpcy5pbWFnZUgpIHtcbiAgICAgICAgICB0aGlzLmltYWdlWSA9IHRoaXMuc2NyZWVuSCAtIHRoaXMuaW1hZ2VIO1xuICAgICAgICAgIHNldE5leHQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKHkyID4gMCkge1xuICAgICAgICAgIGlmICh0aGlzLl9jaGVja092ZXJsYXBwaW5nKCkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmltYWdlWSA+IHRoaXMuaW1hZ2VIKSB7XG4gICAgICAgICAgICAgIHRoaXMuSFRNTGVsZW1lbnQgPSB0aGlzLl9jaGVja092ZXJsYXBwaW5nKCk7XG4gICAgICAgICAgICAgIHRoaXMuaW1hZ2VZID0gTWF0aC5jZWlsKHRoaXMuSFRNTGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wKSAtIHRoaXMuaW1hZ2VIO1xuICAgICAgICAgICAgICBzZXROZXh0ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5IVE1MZWxlbWVudCkge1xuICAgICAgICAgIGlmICghdGhpcy5fY2hlY2tPdmVybGFwcGluZygpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pbWFnZVkgKyB0aGlzLmltYWdlSCA+IHRoaXMuSFRNTGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wICsgMyB8fCB0aGlzLmltYWdlWSArIHRoaXMuaW1hZ2VIIDwgdGhpcy5IVE1MZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgLSAzKSB7XG4gICAgICAgICAgICAgIHRoaXMuSFRNTGVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmltYWdlWCA8IHRoaXMuSFRNTGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCkge1xuICAgICAgICAgICAgICB0aGlzLmltYWdlWCA9IHBhcnNlSW50KHRoaXMuaW1hZ2VYICsgMyk7XG4gICAgICAgICAgICAgIHNldE5leHQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5pbWFnZVggPSBwYXJzZUludCh0aGlzLmltYWdlWCAtIDMpO1xuICAgICAgICAgICAgICBzZXROZXh0ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuRE9NZGl2LnN0eWxlLmxlZnQgPSBwYXJzZUludCh0aGlzLmltYWdlWCkgKyBcInB4XCI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzZXROZXh0KSB7XG4gICAgICAgICAgaWYgKCF0aGlzLl9nZXROZXh0UmFuZG9tTm9kZShib3JkZXJbMF0pKSByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghc2V0TmV4dCAmJiBncmF2aXR5ICYmIGdyYXZpdHlbMF0gJiYgZ3Jhdml0eVswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbmV4dCcpKSB7XG4gICAgICAgIGlmICh0aGlzLmltYWdlWSA8IHRoaXMuc2NyZWVuSCAtIHRoaXMuaW1hZ2VIIC0gMikge1xuICAgICAgICAgIGlmICh0aGlzLkhUTUxlbGVtZW50ID09IG51bGwpIHtcbiAgICAgICAgICAgIHNldE5leHQgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2NoZWNrT3ZlcmxhcHBpbmcoKSkge1xuICAgICAgICAgICAgICBzZXROZXh0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgdGhpcy5IVE1MZWxlbWVudCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHNldE5leHQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fZ2V0TmV4dFJhbmRvbU5vZGUoZ3Jhdml0eVswXSkpIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghc2V0TmV4dCkge1xuICAgICAgICBpZiAodGhpcy5pbWFnZVggPCAtdGhpcy5pbWFnZVcgJiYgeDIgPCAwIHx8IHRoaXMuaW1hZ2VYID4gdGhpcy5zY3JlZW5XICYmIHgyID4gMCB8fCB0aGlzLmltYWdlWSA8IC10aGlzLmltYWdlSCAmJiB5MSA8IDAgfHwgdGhpcy5pbWFnZVkgPiB0aGlzLnNjcmVlbkggJiYgeTIgPiAwKSB7XG4gICAgICAgICAgc2V0TmV4dCA9IHRydWU7XG4gICAgICAgICAgaWYgKCF0aGlzLmlzQ2hpbGQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NwYXduRVNoZWVwKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBzZXRUaW1lb3V0KHRoaXMuX25leHRFU2hlZXBTdGVwLmJpbmQodGhpcyksIHBhcnNlSW50KGRlbDEpICsgcGFyc2VJbnQoKGRlbDIgLSBkZWwxKSAqIHRoaXMuYW5pbWF0aW9uU3RlcCAvIHN0ZXBzKSk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIGVTaGVlcDtcbn0oKTtcblxuOyJdfQ==
